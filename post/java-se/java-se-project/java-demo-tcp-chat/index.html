<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面） | SteamedFish&#39;s Blog</title>
<meta name="keywords" content="GUI, Java, OOP, Swing, 实战Demo, Java SE">
<meta name="description" content="需求分析：

一个用户的登录界面，输入昵称
群聊窗口

展示在线人数（实时更新）
消息展示框
消息输入框
发送按钮


群聊功能

技术选型

GUI编程技术：Swing
网络编程
OOP面对对象设计
一些常用的API

思路分析
1. 创建一个项目模块：chat-system

2. 编写系统界面：Swing代码

登录界面：要求用户输入自己的昵称
package com.itheima.ui;

 import javax.swing.*;
 import java.awt.*;

 public class ChatEntryFrame extends JFrame {
     private JTextField nicknameField;//昵称
     private JButton enterButton;//确定
     private JButton cancelButton;//取消

     public ChatEntryFrame() {//构造方法
         setTitle(&#34;局域网聊天室&#34;);//标题
         setSize(350, 200);//大小
         setLocationRelativeTo(null);//居中
         setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序
         setResizable(false);//不可缩放

         //设置背景颜色
         getContentPane().setBackground(new Color(0xF0F0F0));

         //创建主面板并设置布局
         JPanel mainPanel = new JPanel(new BorderLayout());
         mainPanel.setBackground(new Color(0xF0F0F0));
         add(mainPanel);

         //创建顶部面板
         JPanel topPanel = new JPanel(new  FlowLayout(FlowLayout.CENTER,10,10));
         topPanel.setBackground(new Color(0xF0F0F0));

         //标签和文本框
         JLabel nicknameLabel = new JLabel(&#34;昵称：&#34;);
         nicknameLabel.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         nicknameField = new JTextField(10);
         nicknameField.setFont(new Font(&#34;微软雅黑&#34;,Font.PLAIN,16));
         nicknameField.setBorder(BorderFactory.createCompoundBorder(
             BorderFactory.createMatteBorder(1,1,1,1,Color.GRAY),
             BorderFactory.createEmptyBorder(5,5,5,5)
         ));

         topPanel.add(nicknameLabel);
         topPanel.add(nicknameField);
         mainPanel.add(topPanel,BorderLayout.NORTH);

         //按钮面板
         JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10));
         buttonPanel.setBackground(new Color(0xF0F0F0));

         enterButton = new JButton(&#34;确定&#34;);
         enterButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         enterButton.setBackground(new Color(0x4CAF50));
         enterButton.setForeground(Color.WHITE);
         enterButton.setBorderPainted(false);
         enterButton.setFocusPainted(false);

         cancelButton = new JButton(&#34;取消&#34;);
         cancelButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         cancelButton.setBackground(new Color(0xF44336));
         cancelButton.setForeground(Color.WHITE);
         cancelButton.setBorderPainted(false);
         cancelButton.setFocusPainted(false);

         buttonPanel.add(enterButton);
         buttonPanel.add(cancelButton);
         mainPanel.add(buttonPanel,BorderLayout.SOUTH);

         //添加监听
         enterButton.addActionListener(e -&gt; {
             String nickname = nicknameField.getText();
             if (!nickname.isEmpty()){
                 //进入聊天室
                 dispose();//销毁当前窗口
             }else{
                 JOptionPane.showMessageDialog(this,&#34;请输入昵称！&#34;);
             }
         });

         cancelButton.addActionListener(e -&gt; {
             System.exit(0);
         });//退出程序

         this.setVisible(true);//显示
     }

     public static void main(String[] args) {
         new ChatEntryFrame();
     }
 }

聊天界面：
package com.itheima.ui;

import javax.swing.*;
import java.awt.*;

public class ClientChatFrame extends JFrame {
    public JTextArea smsContent = new JTextArea(23, 50);
    private JTextArea smsSend = new JTextArea(4, 40);
    public JList&lt;String&gt; userList = new JList&lt;&gt;();
    public JButton btnSend = new JButton(&#34;发送&#34;);

    public ClientChatFrame() {
        initView();
        this.setVisible(true);
    }

    private void initView() {
        // 设置窗口基本属性
        this.setSize(800, 600);
        this.setLayout(new BorderLayout(5, 5)); // 添加组件间距
        this.setLocationRelativeTo(null);//居中
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // 设置窗口背景颜色
        this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5));

        // 设置字体
        Font font = new Font(&#34;微软雅黑&#34;, Font.PLAIN, 14);
        Font boldFont = new Font(&#34;微软雅黑&#34;, Font.BOLD, 14);

        // 消息内容框
        smsContent.setFont(font);
        smsContent.setBackground(Color.WHITE);
        smsContent.setEditable(false);
        smsContent.setLineWrap(true);
        smsContent.setWrapStyleWord(true);
        smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

        // 发送消息框
        smsSend.setFont(font);
        smsSend.setWrapStyleWord(true);
        smsSend.setLineWrap(true);
        smsSend.setBorder(BorderFactory.createCompoundBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)),
                BorderFactory.createEmptyBorder(5, 5, 5, 5)
        ));

        // 创建底部面板
        JPanel bottomPanel = new JPanel(new BorderLayout(5, 5));
        bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

        // 消息输入框滚动面板
        JScrollPane smsSendScrollPanel = new JScrollPane(smsSend);
        smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder());
        smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);

        // 发送按钮
        btnSend.setFont(boldFont);
        btnSend.setBackground(new Color(0x4CAF50));
        btnSend.setForeground(Color.WHITE);
        btnSend.setBorderPainted(false);
        btnSend.setFocusPainted(false);
        btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR));
        btnSend.setPreferredSize(new Dimension(80, 40));

        // 按钮面板
        JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5));
        btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        btnsPanel.add(btnSend);

        // 添加底部组件
        bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER);
        bottomPanel.add(btnsPanel, BorderLayout.SOUTH);

        // 用户列表
        userList.setFont(font);
        userList.setBackground(Color.WHITE);
        userList.setSelectionBackground(new Color(0x4CAF50));
        userList.setSelectionForeground(Color.WHITE);

        // 用户列表面板
        JPanel userListPanel = new JPanel(new BorderLayout());
        userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        userListPanel.setBorder(BorderFactory.createTitledBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), 
                &#34;在线用户&#34;, 
                0, 
                0, 
                boldFont
        ));

        JScrollPane userListScrollPanel = new JScrollPane(userList);
        userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5));
        userListPanel.add(userListScrollPanel, BorderLayout.CENTER);
        userListPanel.setPreferredSize(new Dimension(150, 0));

        // 中心消息面板
        JPanel smsContentPanel = new JPanel(new BorderLayout());
        smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        smsContentPanel.setBorder(BorderFactory.createTitledBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), 
                &#34;消息记录&#34;, 
                0, 
                0, 
                boldFont
        ));

        JScrollPane smsContentScrollPanel = new JScrollPane(smsContent);
        smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
        smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
        smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER);

        // 添加组件到主窗口
        this.add(smsContentPanel, BorderLayout.CENTER);
        this.add(userListPanel, BorderLayout.EAST);
        this.add(bottomPanel, BorderLayout.SOUTH);


    }

    public static void main(String[] args) {
        new ClientChatFrame();
    }
}


3. 定义一个App启动类：创建进入界面对象并展示
4. 分析系统整体架构
">
<meta name="author" content="">
<link rel="canonical" href="https://www.steamedfish.top/post/java-se/java-se-project/java-demo-tcp-chat/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css" integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn&#43;yY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.steamedfish.top/favicon.png">
<link rel="apple-touch-icon" href="https://www.steamedfish.top/favicon.png">
<link rel="mask-icon" href="https://www.steamedfish.top/favicon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://www.steamedfish.top/post/java-se/java-se-project/java-demo-tcp-chat/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://www.steamedfish.top/post/java-se/java-se-project/java-demo-tcp-chat/">
  <meta property="og:site_name" content="SteamedFish&#39;s Blog">
  <meta property="og:title" content="项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）">
  <meta property="og:description" content="需求分析： 一个用户的登录界面，输入昵称 群聊窗口 展示在线人数（实时更新） 消息展示框 消息输入框 发送按钮 群聊功能 技术选型 GUI编程技术：Swing 网络编程 OOP面对对象设计 一些常用的API 思路分析 1. 创建一个项目模块：chat-system 2. 编写系统界面：Swing代码 登录界面：要求用户输入自己的昵称 package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ChatEntryFrame extends JFrame { private JTextField nicknameField;//昵称 private JButton enterButton;//确定 private JButton cancelButton;//取消 public ChatEntryFrame() {//构造方法 setTitle(&#34;局域网聊天室&#34;);//标题 setSize(350, 200);//大小 setLocationRelativeTo(null);//居中 setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序 setResizable(false);//不可缩放 //设置背景颜色 getContentPane().setBackground(new Color(0xF0F0F0)); //创建主面板并设置布局 JPanel mainPanel = new JPanel(new BorderLayout()); mainPanel.setBackground(new Color(0xF0F0F0)); add(mainPanel); //创建顶部面板 JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); topPanel.setBackground(new Color(0xF0F0F0)); //标签和文本框 JLabel nicknameLabel = new JLabel(&#34;昵称：&#34;); nicknameLabel.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16)); nicknameField = new JTextField(10); nicknameField.setFont(new Font(&#34;微软雅黑&#34;,Font.PLAIN,16)); nicknameField.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createMatteBorder(1,1,1,1,Color.GRAY), BorderFactory.createEmptyBorder(5,5,5,5) )); topPanel.add(nicknameLabel); topPanel.add(nicknameField); mainPanel.add(topPanel,BorderLayout.NORTH); //按钮面板 JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); buttonPanel.setBackground(new Color(0xF0F0F0)); enterButton = new JButton(&#34;确定&#34;); enterButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16)); enterButton.setBackground(new Color(0x4CAF50)); enterButton.setForeground(Color.WHITE); enterButton.setBorderPainted(false); enterButton.setFocusPainted(false); cancelButton = new JButton(&#34;取消&#34;); cancelButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16)); cancelButton.setBackground(new Color(0xF44336)); cancelButton.setForeground(Color.WHITE); cancelButton.setBorderPainted(false); cancelButton.setFocusPainted(false); buttonPanel.add(enterButton); buttonPanel.add(cancelButton); mainPanel.add(buttonPanel,BorderLayout.SOUTH); //添加监听 enterButton.addActionListener(e -&gt; { String nickname = nicknameField.getText(); if (!nickname.isEmpty()){ //进入聊天室 dispose();//销毁当前窗口 }else{ JOptionPane.showMessageDialog(this,&#34;请输入昵称！&#34;); } }); cancelButton.addActionListener(e -&gt; { System.exit(0); });//退出程序 this.setVisible(true);//显示 } public static void main(String[] args) { new ChatEntryFrame(); } } 聊天界面： package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ClientChatFrame extends JFrame { public JTextArea smsContent = new JTextArea(23, 50); private JTextArea smsSend = new JTextArea(4, 40); public JList&lt;String&gt; userList = new JList&lt;&gt;(); public JButton btnSend = new JButton(&#34;发送&#34;); public ClientChatFrame() { initView(); this.setVisible(true); } private void initView() { // 设置窗口基本属性 this.setSize(800, 600); this.setLayout(new BorderLayout(5, 5)); // 添加组件间距 this.setLocationRelativeTo(null);//居中 this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // 设置窗口背景颜色 this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5)); // 设置字体 Font font = new Font(&#34;微软雅黑&#34;, Font.PLAIN, 14); Font boldFont = new Font(&#34;微软雅黑&#34;, Font.BOLD, 14); // 消息内容框 smsContent.setFont(font); smsContent.setBackground(Color.WHITE); smsContent.setEditable(false); smsContent.setLineWrap(true); smsContent.setWrapStyleWord(true); smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); // 发送消息框 smsSend.setFont(font); smsSend.setWrapStyleWord(true); smsSend.setLineWrap(true); smsSend.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), BorderFactory.createEmptyBorder(5, 5, 5, 5) )); // 创建底部面板 JPanel bottomPanel = new JPanel(new BorderLayout(5, 5)); bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5)); // 消息输入框滚动面板 JScrollPane smsSendScrollPanel = new JScrollPane(smsSend); smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder()); smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED); // 发送按钮 btnSend.setFont(boldFont); btnSend.setBackground(new Color(0x4CAF50)); btnSend.setForeground(Color.WHITE); btnSend.setBorderPainted(false); btnSend.setFocusPainted(false); btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR)); btnSend.setPreferredSize(new Dimension(80, 40)); // 按钮面板 JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5)); btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); btnsPanel.add(btnSend); // 添加底部组件 bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER); bottomPanel.add(btnsPanel, BorderLayout.SOUTH); // 用户列表 userList.setFont(font); userList.setBackground(Color.WHITE); userList.setSelectionBackground(new Color(0x4CAF50)); userList.setSelectionForeground(Color.WHITE); // 用户列表面板 JPanel userListPanel = new JPanel(new BorderLayout()); userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); userListPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), &#34;在线用户&#34;, 0, 0, boldFont )); JScrollPane userListScrollPanel = new JScrollPane(userList); userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5)); userListPanel.add(userListScrollPanel, BorderLayout.CENTER); userListPanel.setPreferredSize(new Dimension(150, 0)); // 中心消息面板 JPanel smsContentPanel = new JPanel(new BorderLayout()); smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); smsContentPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), &#34;消息记录&#34;, 0, 0, boldFont )); JScrollPane smsContentScrollPanel = new JScrollPane(smsContent); smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS); smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER); // 添加组件到主窗口 this.add(smsContentPanel, BorderLayout.CENTER); this.add(userListPanel, BorderLayout.EAST); this.add(bottomPanel, BorderLayout.SOUTH); } public static void main(String[] args) { new ClientChatFrame(); } } 3. 定义一个App启动类：创建进入界面对象并展示 4. 分析系统整体架构 ">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-11-09T10:57:37+00:00">
    <meta property="article:modified_time" content="2025-11-15T16:03:38+00:00">
    <meta property="article:tag" content="GUI">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="OOP">
    <meta property="article:tag" content="Swing">
    <meta property="article:tag" content="实战Demo">
    <meta property="article:tag" content="Java SE">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）">
<meta name="twitter:description" content="需求分析：

一个用户的登录界面，输入昵称
群聊窗口

展示在线人数（实时更新）
消息展示框
消息输入框
发送按钮


群聊功能

技术选型

GUI编程技术：Swing
网络编程
OOP面对对象设计
一些常用的API

思路分析
1. 创建一个项目模块：chat-system

2. 编写系统界面：Swing代码

登录界面：要求用户输入自己的昵称
package com.itheima.ui;

 import javax.swing.*;
 import java.awt.*;

 public class ChatEntryFrame extends JFrame {
     private JTextField nicknameField;//昵称
     private JButton enterButton;//确定
     private JButton cancelButton;//取消

     public ChatEntryFrame() {//构造方法
         setTitle(&#34;局域网聊天室&#34;);//标题
         setSize(350, 200);//大小
         setLocationRelativeTo(null);//居中
         setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序
         setResizable(false);//不可缩放

         //设置背景颜色
         getContentPane().setBackground(new Color(0xF0F0F0));

         //创建主面板并设置布局
         JPanel mainPanel = new JPanel(new BorderLayout());
         mainPanel.setBackground(new Color(0xF0F0F0));
         add(mainPanel);

         //创建顶部面板
         JPanel topPanel = new JPanel(new  FlowLayout(FlowLayout.CENTER,10,10));
         topPanel.setBackground(new Color(0xF0F0F0));

         //标签和文本框
         JLabel nicknameLabel = new JLabel(&#34;昵称：&#34;);
         nicknameLabel.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         nicknameField = new JTextField(10);
         nicknameField.setFont(new Font(&#34;微软雅黑&#34;,Font.PLAIN,16));
         nicknameField.setBorder(BorderFactory.createCompoundBorder(
             BorderFactory.createMatteBorder(1,1,1,1,Color.GRAY),
             BorderFactory.createEmptyBorder(5,5,5,5)
         ));

         topPanel.add(nicknameLabel);
         topPanel.add(nicknameField);
         mainPanel.add(topPanel,BorderLayout.NORTH);

         //按钮面板
         JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10));
         buttonPanel.setBackground(new Color(0xF0F0F0));

         enterButton = new JButton(&#34;确定&#34;);
         enterButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         enterButton.setBackground(new Color(0x4CAF50));
         enterButton.setForeground(Color.WHITE);
         enterButton.setBorderPainted(false);
         enterButton.setFocusPainted(false);

         cancelButton = new JButton(&#34;取消&#34;);
         cancelButton.setFont(new Font(&#34;微软雅黑&#34;,Font.BOLD,16));
         cancelButton.setBackground(new Color(0xF44336));
         cancelButton.setForeground(Color.WHITE);
         cancelButton.setBorderPainted(false);
         cancelButton.setFocusPainted(false);

         buttonPanel.add(enterButton);
         buttonPanel.add(cancelButton);
         mainPanel.add(buttonPanel,BorderLayout.SOUTH);

         //添加监听
         enterButton.addActionListener(e -&gt; {
             String nickname = nicknameField.getText();
             if (!nickname.isEmpty()){
                 //进入聊天室
                 dispose();//销毁当前窗口
             }else{
                 JOptionPane.showMessageDialog(this,&#34;请输入昵称！&#34;);
             }
         });

         cancelButton.addActionListener(e -&gt; {
             System.exit(0);
         });//退出程序

         this.setVisible(true);//显示
     }

     public static void main(String[] args) {
         new ChatEntryFrame();
     }
 }

聊天界面：
package com.itheima.ui;

import javax.swing.*;
import java.awt.*;

public class ClientChatFrame extends JFrame {
    public JTextArea smsContent = new JTextArea(23, 50);
    private JTextArea smsSend = new JTextArea(4, 40);
    public JList&lt;String&gt; userList = new JList&lt;&gt;();
    public JButton btnSend = new JButton(&#34;发送&#34;);

    public ClientChatFrame() {
        initView();
        this.setVisible(true);
    }

    private void initView() {
        // 设置窗口基本属性
        this.setSize(800, 600);
        this.setLayout(new BorderLayout(5, 5)); // 添加组件间距
        this.setLocationRelativeTo(null);//居中
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // 设置窗口背景颜色
        this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5));

        // 设置字体
        Font font = new Font(&#34;微软雅黑&#34;, Font.PLAIN, 14);
        Font boldFont = new Font(&#34;微软雅黑&#34;, Font.BOLD, 14);

        // 消息内容框
        smsContent.setFont(font);
        smsContent.setBackground(Color.WHITE);
        smsContent.setEditable(false);
        smsContent.setLineWrap(true);
        smsContent.setWrapStyleWord(true);
        smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

        // 发送消息框
        smsSend.setFont(font);
        smsSend.setWrapStyleWord(true);
        smsSend.setLineWrap(true);
        smsSend.setBorder(BorderFactory.createCompoundBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)),
                BorderFactory.createEmptyBorder(5, 5, 5, 5)
        ));

        // 创建底部面板
        JPanel bottomPanel = new JPanel(new BorderLayout(5, 5));
        bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

        // 消息输入框滚动面板
        JScrollPane smsSendScrollPanel = new JScrollPane(smsSend);
        smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder());
        smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);

        // 发送按钮
        btnSend.setFont(boldFont);
        btnSend.setBackground(new Color(0x4CAF50));
        btnSend.setForeground(Color.WHITE);
        btnSend.setBorderPainted(false);
        btnSend.setFocusPainted(false);
        btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR));
        btnSend.setPreferredSize(new Dimension(80, 40));

        // 按钮面板
        JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5));
        btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        btnsPanel.add(btnSend);

        // 添加底部组件
        bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER);
        bottomPanel.add(btnsPanel, BorderLayout.SOUTH);

        // 用户列表
        userList.setFont(font);
        userList.setBackground(Color.WHITE);
        userList.setSelectionBackground(new Color(0x4CAF50));
        userList.setSelectionForeground(Color.WHITE);

        // 用户列表面板
        JPanel userListPanel = new JPanel(new BorderLayout());
        userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        userListPanel.setBorder(BorderFactory.createTitledBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), 
                &#34;在线用户&#34;, 
                0, 
                0, 
                boldFont
        ));

        JScrollPane userListScrollPanel = new JScrollPane(userList);
        userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5));
        userListPanel.add(userListScrollPanel, BorderLayout.CENTER);
        userListPanel.setPreferredSize(new Dimension(150, 0));

        // 中心消息面板
        JPanel smsContentPanel = new JPanel(new BorderLayout());
        smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5));
        smsContentPanel.setBorder(BorderFactory.createTitledBorder(
                BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), 
                &#34;消息记录&#34;, 
                0, 
                0, 
                boldFont
        ));

        JScrollPane smsContentScrollPanel = new JScrollPane(smsContent);
        smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
        smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
        smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER);

        // 添加组件到主窗口
        this.add(smsContentPanel, BorderLayout.CENTER);
        this.add(userListPanel, BorderLayout.EAST);
        this.add(bottomPanel, BorderLayout.SOUTH);


    }

    public static void main(String[] args) {
        new ClientChatFrame();
    }
}


3. 定义一个App启动类：创建进入界面对象并展示
4. 分析系统整体架构
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.steamedfish.top/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）",
      "item": "https://www.steamedfish.top/post/java-se/java-se-project/java-demo-tcp-chat/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）",
  "name": "项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）",
  "description": "需求分析： 一个用户的登录界面，输入昵称 群聊窗口 展示在线人数（实时更新） 消息展示框 消息输入框 发送按钮 群聊功能 技术选型 GUI编程技术：Swing 网络编程 OOP面对对象设计 一些常用的API 思路分析 1. 创建一个项目模块：chat-system 2. 编写系统界面：Swing代码 登录界面：要求用户输入自己的昵称 package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ChatEntryFrame extends JFrame { private JTextField nicknameField;//昵称 private JButton enterButton;//确定 private JButton cancelButton;//取消 public ChatEntryFrame() {//构造方法 setTitle(\u0026#34;局域网聊天室\u0026#34;);//标题 setSize(350, 200);//大小 setLocationRelativeTo(null);//居中 setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序 setResizable(false);//不可缩放 //设置背景颜色 getContentPane().setBackground(new Color(0xF0F0F0)); //创建主面板并设置布局 JPanel mainPanel = new JPanel(new BorderLayout()); mainPanel.setBackground(new Color(0xF0F0F0)); add(mainPanel); //创建顶部面板 JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); topPanel.setBackground(new Color(0xF0F0F0)); //标签和文本框 JLabel nicknameLabel = new JLabel(\u0026#34;昵称：\u0026#34;); nicknameLabel.setFont(new Font(\u0026#34;微软雅黑\u0026#34;,Font.BOLD,16)); nicknameField = new JTextField(10); nicknameField.setFont(new Font(\u0026#34;微软雅黑\u0026#34;,Font.PLAIN,16)); nicknameField.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createMatteBorder(1,1,1,1,Color.GRAY), BorderFactory.createEmptyBorder(5,5,5,5) )); topPanel.add(nicknameLabel); topPanel.add(nicknameField); mainPanel.add(topPanel,BorderLayout.NORTH); //按钮面板 JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); buttonPanel.setBackground(new Color(0xF0F0F0)); enterButton = new JButton(\u0026#34;确定\u0026#34;); enterButton.setFont(new Font(\u0026#34;微软雅黑\u0026#34;,Font.BOLD,16)); enterButton.setBackground(new Color(0x4CAF50)); enterButton.setForeground(Color.WHITE); enterButton.setBorderPainted(false); enterButton.setFocusPainted(false); cancelButton = new JButton(\u0026#34;取消\u0026#34;); cancelButton.setFont(new Font(\u0026#34;微软雅黑\u0026#34;,Font.BOLD,16)); cancelButton.setBackground(new Color(0xF44336)); cancelButton.setForeground(Color.WHITE); cancelButton.setBorderPainted(false); cancelButton.setFocusPainted(false); buttonPanel.add(enterButton); buttonPanel.add(cancelButton); mainPanel.add(buttonPanel,BorderLayout.SOUTH); //添加监听 enterButton.addActionListener(e -\u0026gt; { String nickname = nicknameField.getText(); if (!nickname.isEmpty()){ //进入聊天室 dispose();//销毁当前窗口 }else{ JOptionPane.showMessageDialog(this,\u0026#34;请输入昵称！\u0026#34;); } }); cancelButton.addActionListener(e -\u0026gt; { System.exit(0); });//退出程序 this.setVisible(true);//显示 } public static void main(String[] args) { new ChatEntryFrame(); } } 聊天界面： package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ClientChatFrame extends JFrame { public JTextArea smsContent = new JTextArea(23, 50); private JTextArea smsSend = new JTextArea(4, 40); public JList\u0026lt;String\u0026gt; userList = new JList\u0026lt;\u0026gt;(); public JButton btnSend = new JButton(\u0026#34;发送\u0026#34;); public ClientChatFrame() { initView(); this.setVisible(true); } private void initView() { // 设置窗口基本属性 this.setSize(800, 600); this.setLayout(new BorderLayout(5, 5)); // 添加组件间距 this.setLocationRelativeTo(null);//居中 this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // 设置窗口背景颜色 this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5)); // 设置字体 Font font = new Font(\u0026#34;微软雅黑\u0026#34;, Font.PLAIN, 14); Font boldFont = new Font(\u0026#34;微软雅黑\u0026#34;, Font.BOLD, 14); // 消息内容框 smsContent.setFont(font); smsContent.setBackground(Color.WHITE); smsContent.setEditable(false); smsContent.setLineWrap(true); smsContent.setWrapStyleWord(true); smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); // 发送消息框 smsSend.setFont(font); smsSend.setWrapStyleWord(true); smsSend.setLineWrap(true); smsSend.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), BorderFactory.createEmptyBorder(5, 5, 5, 5) )); // 创建底部面板 JPanel bottomPanel = new JPanel(new BorderLayout(5, 5)); bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5)); // 消息输入框滚动面板 JScrollPane smsSendScrollPanel = new JScrollPane(smsSend); smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder()); smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED); // 发送按钮 btnSend.setFont(boldFont); btnSend.setBackground(new Color(0x4CAF50)); btnSend.setForeground(Color.WHITE); btnSend.setBorderPainted(false); btnSend.setFocusPainted(false); btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR)); btnSend.setPreferredSize(new Dimension(80, 40)); // 按钮面板 JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5)); btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); btnsPanel.add(btnSend); // 添加底部组件 bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER); bottomPanel.add(btnsPanel, BorderLayout.SOUTH); // 用户列表 userList.setFont(font); userList.setBackground(Color.WHITE); userList.setSelectionBackground(new Color(0x4CAF50)); userList.setSelectionForeground(Color.WHITE); // 用户列表面板 JPanel userListPanel = new JPanel(new BorderLayout()); userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); userListPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \u0026#34;在线用户\u0026#34;, 0, 0, boldFont )); JScrollPane userListScrollPanel = new JScrollPane(userList); userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5)); userListPanel.add(userListScrollPanel, BorderLayout.CENTER); userListPanel.setPreferredSize(new Dimension(150, 0)); // 中心消息面板 JPanel smsContentPanel = new JPanel(new BorderLayout()); smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); smsContentPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \u0026#34;消息记录\u0026#34;, 0, 0, boldFont )); JScrollPane smsContentScrollPanel = new JScrollPane(smsContent); smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS); smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER); // 添加组件到主窗口 this.add(smsContentPanel, BorderLayout.CENTER); this.add(userListPanel, BorderLayout.EAST); this.add(bottomPanel, BorderLayout.SOUTH); } public static void main(String[] args) { new ClientChatFrame(); } } 3. 定义一个App启动类：创建进入界面对象并展示 4. 分析系统整体架构 ",
  "keywords": [
    "GUI", "Java", "OOP", "Swing", "实战Demo", "Java SE"
  ],
  "articleBody": "需求分析： 一个用户的登录界面，输入昵称 群聊窗口 展示在线人数（实时更新） 消息展示框 消息输入框 发送按钮 群聊功能 技术选型 GUI编程技术：Swing 网络编程 OOP面对对象设计 一些常用的API 思路分析 1. 创建一个项目模块：chat-system 2. 编写系统界面：Swing代码 登录界面：要求用户输入自己的昵称 package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ChatEntryFrame extends JFrame { private JTextField nicknameField;//昵称 private JButton enterButton;//确定 private JButton cancelButton;//取消 public ChatEntryFrame() {//构造方法 setTitle(\"局域网聊天室\");//标题 setSize(350, 200);//大小 setLocationRelativeTo(null);//居中 setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序 setResizable(false);//不可缩放 //设置背景颜色 getContentPane().setBackground(new Color(0xF0F0F0)); //创建主面板并设置布局 JPanel mainPanel = new JPanel(new BorderLayout()); mainPanel.setBackground(new Color(0xF0F0F0)); add(mainPanel); //创建顶部面板 JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); topPanel.setBackground(new Color(0xF0F0F0)); //标签和文本框 JLabel nicknameLabel = new JLabel(\"昵称：\"); nicknameLabel.setFont(new Font(\"微软雅黑\",Font.BOLD,16)); nicknameField = new JTextField(10); nicknameField.setFont(new Font(\"微软雅黑\",Font.PLAIN,16)); nicknameField.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createMatteBorder(1,1,1,1,Color.GRAY), BorderFactory.createEmptyBorder(5,5,5,5) )); topPanel.add(nicknameLabel); topPanel.add(nicknameField); mainPanel.add(topPanel,BorderLayout.NORTH); //按钮面板 JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,10,10)); buttonPanel.setBackground(new Color(0xF0F0F0)); enterButton = new JButton(\"确定\"); enterButton.setFont(new Font(\"微软雅黑\",Font.BOLD,16)); enterButton.setBackground(new Color(0x4CAF50)); enterButton.setForeground(Color.WHITE); enterButton.setBorderPainted(false); enterButton.setFocusPainted(false); cancelButton = new JButton(\"取消\"); cancelButton.setFont(new Font(\"微软雅黑\",Font.BOLD,16)); cancelButton.setBackground(new Color(0xF44336)); cancelButton.setForeground(Color.WHITE); cancelButton.setBorderPainted(false); cancelButton.setFocusPainted(false); buttonPanel.add(enterButton); buttonPanel.add(cancelButton); mainPanel.add(buttonPanel,BorderLayout.SOUTH); //添加监听 enterButton.addActionListener(e -\u003e { String nickname = nicknameField.getText(); if (!nickname.isEmpty()){ //进入聊天室 dispose();//销毁当前窗口 }else{ JOptionPane.showMessageDialog(this,\"请输入昵称！\"); } }); cancelButton.addActionListener(e -\u003e { System.exit(0); });//退出程序 this.setVisible(true);//显示 } public static void main(String[] args) { new ChatEntryFrame(); } } 聊天界面： package com.itheima.ui; import javax.swing.*; import java.awt.*; public class ClientChatFrame extends JFrame { public JTextArea smsContent = new JTextArea(23, 50); private JTextArea smsSend = new JTextArea(4, 40); public JList\u003cString\u003e userList = new JList\u003c\u003e(); public JButton btnSend = new JButton(\"发送\"); public ClientChatFrame() { initView(); this.setVisible(true); } private void initView() { // 设置窗口基本属性 this.setSize(800, 600); this.setLayout(new BorderLayout(5, 5)); // 添加组件间距 this.setLocationRelativeTo(null);//居中 this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // 设置窗口背景颜色 this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5)); // 设置字体 Font font = new Font(\"微软雅黑\", Font.PLAIN, 14); Font boldFont = new Font(\"微软雅黑\", Font.BOLD, 14); // 消息内容框 smsContent.setFont(font); smsContent.setBackground(Color.WHITE); smsContent.setEditable(false); smsContent.setLineWrap(true); smsContent.setWrapStyleWord(true); smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); // 发送消息框 smsSend.setFont(font); smsSend.setWrapStyleWord(true); smsSend.setLineWrap(true); smsSend.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), BorderFactory.createEmptyBorder(5, 5, 5, 5) )); // 创建底部面板 JPanel bottomPanel = new JPanel(new BorderLayout(5, 5)); bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5)); // 消息输入框滚动面板 JScrollPane smsSendScrollPanel = new JScrollPane(smsSend); smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder()); smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED); // 发送按钮 btnSend.setFont(boldFont); btnSend.setBackground(new Color(0x4CAF50)); btnSend.setForeground(Color.WHITE); btnSend.setBorderPainted(false); btnSend.setFocusPainted(false); btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR)); btnSend.setPreferredSize(new Dimension(80, 40)); // 按钮面板 JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5)); btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); btnsPanel.add(btnSend); // 添加底部组件 bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER); bottomPanel.add(btnsPanel, BorderLayout.SOUTH); // 用户列表 userList.setFont(font); userList.setBackground(Color.WHITE); userList.setSelectionBackground(new Color(0x4CAF50)); userList.setSelectionForeground(Color.WHITE); // 用户列表面板 JPanel userListPanel = new JPanel(new BorderLayout()); userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); userListPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \"在线用户\", 0, 0, boldFont )); JScrollPane userListScrollPanel = new JScrollPane(userList); userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5)); userListPanel.add(userListScrollPanel, BorderLayout.CENTER); userListPanel.setPreferredSize(new Dimension(150, 0)); // 中心消息面板 JPanel smsContentPanel = new JPanel(new BorderLayout()); smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); smsContentPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \"消息记录\", 0, 0, boldFont )); JScrollPane smsContentScrollPanel = new JScrollPane(smsContent); smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS); smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER); // 添加组件到主窗口 this.add(smsContentPanel, BorderLayout.CENTER); this.add(userListPanel, BorderLayout.EAST); this.add(bottomPanel, BorderLayout.SOUTH); } public static void main(String[] args) { new ClientChatFrame(); } } 3. 定义一个App启动类：创建进入界面对象并展示 4. 分析系统整体架构 开发服务端： 接受客户端的管道连接 接受登录消息，接受昵称信息 服务端也可能接受客户端发送的群聊消息 存储所有在线的socket管道。查看在线状态、转发消息 收到登录消息-\u003e接受昵称-\u003e更新在线状态 收到群聊消息-\u003e接受消息-\u003e转发给所有客户端 客户端：在原本的基础上进行完善 5. 先开发完整的服务端 第一步、创建一个服务端的项目模块：chat-server 第二步、创建一个服务器启动类，启动服务器等待客户端的连接 尽量贴近实战开发，所以此处的端口port不写死，用常量池Constant定义常量，方便后续维护 第三步、把socket管道交给一个独立的子线程来处理，以支持多客户端即时通信 package com.localchat; import java.io.IOException; import java.net.ServerSocket; import java.net.Socket; public class Server { public static void main(String[] args) { System.out.println(\"===启动服务端===\"); try { //1.注册端口 ServerSocket serverSocket = new ServerSocket(Constant.PORT); //2.主线程循环监听 while (true) { //3.调用accept()方法，阻塞等待客户端连接，连接成功返回一个Socket对象 System.out.println(\"等待客户端连接...\"); Socket socket = serverSocket.accept(); new ServerReaderThread(socket).start(); System.out.println(\"一个客户端上线了\"); } } catch (IOException e) { e.printStackTrace(); } } } 第四步、定义一个集合容器存储所有在线客户端 这个集合只需要一个 //定义一个集合容器存储所有上线的在线用户 //定义一个Map集合，键：Socket对象，值：用户名 public static final Map\u003cSocket, String\u003e onLineSockets = new HashMap\u003c\u003e(); 第五步、服务端线程接受登录消息/群聊消息 //消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息 //所以客户端必须声明协议发送消息 //比如客户端先发送一个数字1，表示登录消息 //数字2表示群聊消息 //数字3表示私聊消息 先接受一个整数，进行判断，然后执行逻辑\npackage com.localchat; import java.io.DataInputStream; import java.net.Socket; public class ServerReaderThread extends Thread { private Socket socket; public ServerReaderThread(Socket socket) { this.socket = socket; } @Override public void run() { try { //消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息 //所以客户端必须声明协议发送消息 //比如客户端先发送一个数字1，表示登录消息 //数字2表示群聊消息 //数字3表示私聊消息 //先从管道读取数字 DataInputStream dis = new DataInputStream(socket.getInputStream()); int type = dis.readInt(); switch (type) { case 1: //登录消息，更新在线用户列表 break; case 2: //群聊消息，读取消息内容，发送给所有在线用户 break; case 3: //私聊消息，读取消息内容，发送给指定用户 break; } } catch (Exception e) { System.out.println(\"客户端下线了：\" + socket.getInetAddress().getHostAddress()); } } } 第六步、实现服务端的登录消息接收 package com.localchat; import java.io.DataInputStream; import java.io.DataOutputStream; import java.net.Socket; import java.util.Collection; public class ServerReaderThread extends Thread { private Socket socket; public ServerReaderThread(Socket socket) { this.socket = socket; } @Override public void run() { try { //消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息 //所以客户端必须声明协议发送消息 //比如客户端先发送一个数字1，表示登录消息 //数字2表示群聊消息 //数字3表示私聊消息 //数字4表示退出登录/下线消息 //先从管道读取数字 DataInputStream dis = new DataInputStream(socket.getInputStream()); int type = dis.readInt(); switch (type) { case 1: //登录消息，更新在线用户列表 String nickName = dis.readUTF(); //把昵称保存到在线集合中 Server.onLineSockets.put(socket, nickName); //发送在线用户列表给所有用户 updateClientOnlineUserList(); break; case 2: //群聊消息，读取消息内容，发送给所有在线用户 break; case 3: //私聊消息，读取消息内容，发送给指定用户 break; } } catch (Exception e) { System.out.println(\"客户端下线了：\" + socket.getInetAddress().getHostAddress()); Server.onLineSockets.remove(socket); } } private void updateClientOnlineUserList() { //更新全部客户端的在线人数 //拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道 //1.拿到全部在线用户名称 Collection\u003cString\u003e onlineUsers = Server.onLineSockets.values(); //2.把用户名称发送给全部在线socket管道 for (Socket socket : Server.onLineSockets.keySet()){ try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(1);//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息 dos.writeInt(onlineUsers.size());//告诉客户端，本次登录的用户数量 for (String onlineUser : onlineUsers) { dos.writeUTF(onlineUser); } dos.flush();//刷新管道,立即发送 } catch (Exception e) { e.printStackTrace(); } } } } 第七步、接收客户端的群聊消息 package com.localchat; import java.io.DataInputStream; import java.io.DataOutputStream; import java.net.Socket; import java.time.LocalDateTime; import java.time.format.DateTimeFormatter; import java.util.Collection; public class ServerReaderThread extends Thread { private Socket socket; public ServerReaderThread(Socket socket) { this.socket = socket; } @Override public void run() { try { //消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息 //所以客户端必须声明协议发送消息 //比如客户端先发送一个数字1，表示登录消息 //数字2表示群聊消息 //数字3表示私聊消息 //数字4表示退出登录/下线消息 //先从管道读取数字 DataInputStream dis = new DataInputStream(socket.getInputStream()); while (true) { int type = dis.readInt(); switch (type) { case 1: //登录消息，更新在线用户列表 String nickName = dis.readUTF(); //把昵称保存到在线集合中 Server.onLineSockets.put(socket, nickName); //发送在线用户列表给所有用户 updateClientOnlineUserList(); break; case 2: //群聊消息，读取消息内容，发送给所有在线用户 String msg = dis.readUTF(); sendMsgToAll(msg); break; case 3: //私聊消息，读取消息内容，发送给指定用户 break; } } } catch (Exception e) { System.out.println(\"客户端下线了：\" + socket.getInetAddress().getHostAddress()); Server.onLineSockets.remove(socket);//移除下线的用户 updateClientOnlineUserList();//刷新在线人数 } } //发送群聊消息给所有在线用户 private void sendMsgToAll(String msg) { //拼装好这个消息再发送 StringBuilder sb = new StringBuilder(); String name = Server.onLineSockets.get(socket); LocalDateTime now = LocalDateTime.now(); DateTimeFormatter dtf = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss EEE a\"); String nowStr = dtf.format(now); String msgResult = sb.append(name).append(\" \").append(nowStr).append(\"\\r\\n\") .append(msg).append(\"\\r\\n\").toString(); //1.把消息发送给全部在线socket管道 try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(2);//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息 dos.writeUTF(msgResult); dos.flush();//刷新管道,立即发送 } catch (Exception e) { e.printStackTrace(); } } private void updateClientOnlineUserList() { //更新全部客户端的在线人数 //拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道 //1.拿到全部在线用户名称 Collection\u003cString\u003e onlineUsers = Server.onLineSockets.values(); //2.把用户名称发送给全部在线socket管道 for (Socket socket : Server.onLineSockets.keySet()) { try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(1);//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息 dos.writeInt(onlineUsers.size());//告诉客户端，本次登录的用户数量 for (String onlineUser : onlineUsers) { dos.writeUTF(onlineUser); } dos.flush();//刷新管道,立即发送 } catch (Exception e) { e.printStackTrace(); } } } } 6.完善客户端程序代码 第一步、完善登录界面\n为进入按钮绑定点击事件监听器，点击后获取昵称，请求与服务器端的socket管道连接-\u003e发送'1’-\u003e发送昵称-\u003e进入界面-\u003e接收socket管道\n第二步、读取客户端socket管道从发u五点发来的在线人数更新消息/群聊消息\n创建一个独立的线程负责读取客户端socket从服务端收取的数据（人数更新/消息数据） 收到消息后，进行判断，根据消息类型分类处理 第三步、接收群聊消息\n接收消息类型2 -\u003e 接收群聊数据-\u003e展示到界面 第四步、发送群聊消息\n为发送按钮绑定一个点击事件，获取输入框的消息内容-\u003e发送2 -\u003e 发送消息-\u003e更新消息框 成品展示 代码展示 ├─chat-server │ │ chat-server.iml │ │ │ └─src │ └─com │ └─localchat │ Constant.java │ Server.java │ ServerReaderThread.java │ ├─chat-system │ │ chat-system.iml │ │ │ └─src │ │ App.java │ │ │ └─com │ └─localchat │ └─ui │ ChatEntryFrame.java │ ClientChatFrame.java │ ClientReaderThread.java │ Constant.java Constant.java\npackage com.localchat; public class Constant { public static final int PORT = 8888; } Server.java\npackage com.localchat; import java.io.IOException; import java.net.ServerSocket; import java.net.Socket; import java.util.HashMap; import java.util.Map; public class Server { //定义一个集合容器存储所有上线的在线用户 //定义一个Map集合，键：Socket对象，值：用户名 public static final Map\u003cSocket, String\u003e onLineSockets = new HashMap\u003c\u003e(); public static void main(String[] args) { System.out.println(\"===启动服务端===\"); try { //1.注册端口 ServerSocket serverSocket = new ServerSocket(Constant.PORT); //2.主线程循环监听 while (true) { //3.调用accept()方法，阻塞等待客户端连接，连接成功返回一个Socket对象 System.out.println(\"等待客户端连接...\"); Socket socket = serverSocket.accept(); // 把socket管道交给一个独立的子线程来处理，以支持多客户端即时通信 new ServerReaderThread(socket).start(); System.out.println(\"一个客户端上线了\"); } } catch (IOException e) { e.printStackTrace(); } } } ServerReaderThread.java\npackage com.localchat; import java.io.DataInputStream; import java.io.DataOutputStream; import java.net.Socket; import java.time.LocalDateTime; import java.time.format.DateTimeFormatter; import java.util.Collection; public class ServerReaderThread extends Thread { private Socket socket; public ServerReaderThread(Socket socket) { this.socket = socket; } @Override public void run() { try { //消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息 //所以客户端必须声明协议发送消息 //比如客户端先发送一个数字1，表示登录消息 //数字2表示群聊消息 //数字3表示私聊消息 //数字4表示退出登录/下线消息 //先从管道读取数字 DataInputStream dis = new DataInputStream(socket.getInputStream()); while (true) { int type = dis.readInt(); switch (type) { case 1: //登录消息，更新在线用户列表 String nickName = dis.readUTF(); //把昵称保存到在线集合中 Server.onLineSockets.put(socket, nickName); //发送在线用户列表给所有用户 updateClientOnlineUserList(); break; case 2: //群聊消息，读取消息内容，发送给所有在线用户 String msg = dis.readUTF(); sendMsgToAll(msg); break; case 3: //私聊消息，读取消息内容，发送给指定用户 break; } } } catch (Exception e) { System.out.println(\"客户端下线了：\" + socket.getInetAddress().getHostAddress()); Server.onLineSockets.remove(socket);//移除下线的用户 updateClientOnlineUserList();//刷新在线人数 } } //发送群聊消息给所有在线用户 private void sendMsgToAll(String msg) { //拼装好这个消息再发送 StringBuilder sb = new StringBuilder(); String name = Server.onLineSockets.get(socket); LocalDateTime now = LocalDateTime.now(); DateTimeFormatter dtf = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss EEE a\"); String nowStr = dtf.format(now); String msgResult = sb.append(name).append(\" \").append(nowStr).append(\"\\r\\n\") .append(msg).append(\"\\r\\n\").toString(); //1.把消息发送给全部在线socket管道 for (Socket socket : Server.onLineSockets.keySet()) { try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(2);//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息 dos.writeUTF(msgResult); dos.flush();//刷新管道,立即发送 } catch (Exception e) { e.printStackTrace(); } } } private void updateClientOnlineUserList() { //更新全部客户端的在线人数 //拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道 //1.拿到全部在线用户名称 Collection\u003cString\u003e onlineUsers = Server.onLineSockets.values(); //2.把用户名称发送给全部在线socket管道 for (Socket socket : Server.onLineSockets.keySet()) { try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(1);//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息 dos.writeInt(onlineUsers.size());//告诉客户端，本次登录的用户数量 for (String onlineUser : onlineUsers) { dos.writeUTF(onlineUser); } dos.flush();//刷新管道,立即发送 } catch (Exception e) { e.printStackTrace(); } } } } ChatEntryFrame.java\npackage com.localchat.ui; import javax.swing.*; import java.awt.*; import java.io.DataOutputStream; import java.io.IOException; import java.net.Socket; public class ChatEntryFrame extends JFrame { private JTextField nicknameField;//昵称 private JButton enterButton;//确定 private JButton cancelButton;//取消 private Socket socket; public ChatEntryFrame() {//构造方法 setTitle(\"局域网聊天室\");//标题 setSize(350, 200);//大小 setLocationRelativeTo(null);//居中 setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//退出程序 setResizable(false);//不可缩放 //设置背景颜色 getContentPane().setBackground(new Color(0xF0F0F0)); //创建主面板并设置布局 JPanel mainPanel = new JPanel(new BorderLayout()); mainPanel.setBackground(new Color(0xF0F0F0)); add(mainPanel); //创建顶部面板 JPanel topPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 10, 10)); topPanel.setBackground(new Color(0xF0F0F0)); //标签和文本框 JLabel nicknameLabel = new JLabel(\"昵称：\"); nicknameLabel.setFont(new Font(\"微软雅黑\", Font.BOLD, 16)); nicknameField = new JTextField(10); nicknameField.setFont(new Font(\"微软雅黑\", Font.PLAIN, 16)); nicknameField.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.GRAY), BorderFactory.createEmptyBorder(5, 5, 5, 5))); topPanel.add(nicknameLabel); topPanel.add(nicknameField); mainPanel.add(topPanel, BorderLayout.NORTH); //按钮面板 JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 10, 10)); buttonPanel.setBackground(new Color(0xF0F0F0)); enterButton = new JButton(\"登录\"); enterButton.setFont(new Font(\"微软雅黑\", Font.BOLD, 16)); enterButton.setBackground(new Color(0x4CAF50)); enterButton.setForeground(Color.WHITE); enterButton.setBorderPainted(false); enterButton.setFocusPainted(false); cancelButton = new JButton(\"取消\"); cancelButton.setFont(new Font(\"微软雅黑\", Font.BOLD, 16)); cancelButton.setBackground(new Color(0xF44336)); cancelButton.setForeground(Color.WHITE); cancelButton.setBorderPainted(false); cancelButton.setFocusPainted(false); buttonPanel.add(enterButton); buttonPanel.add(cancelButton); mainPanel.add(buttonPanel, BorderLayout.SOUTH); //添加监听 enterButton.addActionListener(e -\u003e { String nickname = nicknameField.getText();//获取昵称 nicknameField.setText(\"\");//清空文本框 if (!nickname.isEmpty()) { //发送登录消息给服务器端 try { login(nickname); //进入聊天室 new ClientChatFrame(nickname, socket); } catch (IOException ex) { ex.printStackTrace(); } dispose();//销毁当前窗口 } else { JOptionPane.showMessageDialog(this, \"请输入昵称！\"); } }); cancelButton.addActionListener(e -\u003e { System.exit(0); });//退出程序 this.setVisible(true);//显示 } private void login(String nickname) throws IOException { //1.创建socket管道 socket = new Socket(Constant.SERVER_IP, Constant.SERVER_PORT); //2.获取输出流，发送登录消息给服务器端 DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); dos.writeInt(1);//消息类型：1：登录 dos.writeUTF(nickname); dos.flush(); } public static void main(String[] args) { new ChatEntryFrame(); } } ClientChatFrame.java\npackage com.localchat.ui; import javax.swing.*; import java.awt.*; import java.io.DataOutputStream; import java.io.IOException; import java.net.Socket; public class ClientChatFrame extends JFrame { public JTextArea smsContent = new JTextArea(23, 50); private JTextArea smsSend = new JTextArea(4, 40); public JList\u003cString\u003e userList = new JList\u003c\u003e(); public JButton btnSend = new JButton(\"发送\"); private String nickname; private Socket socket; public ClientChatFrame() { initView(); this.setVisible(true); } public ClientChatFrame(String nickname, Socket socket) { this();//调用无参构造方法，初始化界面 //初始化数据 //把昵称展示到标题中 this.setTitle(nickname + \"的聊天窗口\"); this.nickname = nickname; this.socket = socket; //启动线程，接收服务端发送的消息 new ClientReaderThread(socket, this).start(); } private void initView() { // 设置窗口基本属性 this.setSize(800, 600); this.setLayout(new BorderLayout(5, 5)); // 添加组件间距 this.setLocationRelativeTo(null);//居中 this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // 设置窗口背景颜色 this.getContentPane().setBackground(new Color(0xf5, 0xf5, 0xf5)); // 设置字体 Font font = new Font(\"微软雅黑\", Font.PLAIN, 14); Font boldFont = new Font(\"微软雅黑\", Font.BOLD, 14); // 消息内容框 smsContent.setFont(font); smsContent.setBackground(Color.WHITE); smsContent.setEditable(false); smsContent.setLineWrap(true); smsContent.setWrapStyleWord(true); smsContent.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); // 发送消息框 smsSend.setFont(font); smsSend.setWrapStyleWord(true); smsSend.setLineWrap(true); smsSend.setBorder(BorderFactory.createCompoundBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), BorderFactory.createEmptyBorder(5, 5, 5, 5) )); // 创建底部面板 JPanel bottomPanel = new JPanel(new BorderLayout(5, 5)); bottomPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); bottomPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5)); // 消息输入框滚动面板 JScrollPane smsSendScrollPanel = new JScrollPane(smsSend); smsSendScrollPanel.setBorder(BorderFactory.createEmptyBorder()); smsSendScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED); // 发送按钮 btnSend.setFont(boldFont); btnSend.setBackground(new Color(0x4CAF50)); btnSend.setForeground(Color.WHITE); btnSend.setBorderPainted(false); btnSend.setFocusPainted(false); btnSend.setCursor(new Cursor(Cursor.HAND_CURSOR)); btnSend.setPreferredSize(new Dimension(80, 40)); // 按钮面板 JPanel btnsPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 5)); btnsPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); btnsPanel.add(btnSend); // 给发送按钮添加点击监听器 btnSend.addActionListener(e -\u003e { String msg = smsSend.getText(); smsSend.setText(\"\"); sendMsgToServer(msg); }); // 添加底部组件 bottomPanel.add(smsSendScrollPanel, BorderLayout.CENTER); bottomPanel.add(btnsPanel, BorderLayout.SOUTH); // 用户列表 userList.setFont(font); userList.setBackground(Color.WHITE); userList.setSelectionBackground(new Color(0x4CAF50)); userList.setSelectionForeground(Color.WHITE); // 用户列表面板 JPanel userListPanel = new JPanel(new BorderLayout()); userListPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); userListPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \"在线用户\", 0, 0, boldFont )); JScrollPane userListScrollPanel = new JScrollPane(userList); userListScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5)); userListPanel.add(userListScrollPanel, BorderLayout.CENTER); userListPanel.setPreferredSize(new Dimension(150, 0)); // 中心消息面板 JPanel smsContentPanel = new JPanel(new BorderLayout()); smsContentPanel.setBackground(new Color(0xf5, 0xf5, 0xf5)); smsContentPanel.setBorder(BorderFactory.createTitledBorder( BorderFactory.createLineBorder(new Color(0xcc, 0xcc, 0xcc)), \"消息记录\", 0, 0, boldFont )); JScrollPane smsContentScrollPanel = new JScrollPane(smsContent); smsContentScrollPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10)); smsContentScrollPanel.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS); smsContentPanel.add(smsContentScrollPanel, BorderLayout.CENTER); // 添加组件到主窗口 this.add(smsContentPanel, BorderLayout.CENTER); this.add(userListPanel, BorderLayout.EAST); this.add(bottomPanel, BorderLayout.SOUTH); } private void sendMsgToServer(String msg) { //1.从socket管道中获取输出流 try { DataOutputStream dos = new DataOutputStream(socket.getOutputStream()); //2.发送消息给服务端 dos.writeInt(2);//消息类型：2：群聊消息 dos.writeUTF(msg); dos.flush(); } catch (IOException e) { e.printStackTrace(); } } public static void main(String[] args) { new ClientChatFrame(); } public void updateOnlineUsers(String[] onLineNames) { //把这个线程读取到的在线用户更新到界面上 userList.setListData(onLineNames); } //添加消息到界面 public void setMsgToWin(String msg) { //把消息添加到界面中 smsContent.append(msg); } } ClientReaderThread.java\npackage com.localchat.ui; import java.io.DataInputStream; import java.io.IOException; import java.net.Socket; public class ClientReaderThread extends Thread { private Socket socket; private DataInputStream dis; private ClientChatFrame win; public ClientReaderThread(Socket socket, ClientChatFrame win) { this.socket = socket; this.win = win; } @Override public void run() { try { //消息类型：1.在线人数更新2.群聊消息3.私聊消息 dis = new DataInputStream(socket.getInputStream()); while (true) { int type = dis.readInt();//1，2，3 switch (type) { case 1: //登录消息，更新在线用户列表 updateClientOnlineUserList(); break; case 2: //群聊消息，读取消息内容，发送给所有在线用户 getMsgToWin(); break; case 3: //私聊消息，读取消息内容，发送给指定用户 break; } } } catch (Exception e) { e.printStackTrace(); } } private void getMsgToWin() throws IOException { //1.读取消息内容 String msg = dis.readUTF(); win.setMsgToWin(msg); } //更新客户端在线用户列表 private void updateClientOnlineUserList() throws IOException { //1.读取有多少个在线用户信息 int count = dis.readInt(); //2.循环读取用户信息 String[] onLineNames = new String[count]; for (int i = 0; i \u003c count; i++) { //3.读取一个用户信息 String nickname = dis.readUTF(); //4.把用户信息添加到集合中 onLineNames[i] = nickname; } win.updateOnlineUsers(onLineNames); } } Constant.java\npackage com.localchat.ui; public class Constant { public static final String SERVER_IP = \"127.0.0.1\"; public static final int SERVER_PORT = 8888; } ",
  "wordCount" : "7215",
  "inLanguage": "zh",
  "datePublished": "2025-11-09T10:57:37.196Z",
  "dateModified": "2025-11-15T16:03:38.489099811Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.steamedfish.top/post/java-se/java-se-project/java-demo-tcp-chat/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SteamedFish's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.steamedfish.top/favicon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.steamedfish.top/" accesskey="h" title="SteamedFish&#39;s Blog (Alt + H)">SteamedFish&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.steamedfish.top/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/categories/" title="Categories">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/tags/" title="Tags">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.steamedfish.top/">主页</a>&nbsp;»&nbsp;<a href="https://www.steamedfish.top/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      项目实战——基于 TCP 的局域网聊天工具开发（含 GUI 界面）
    </h1>
    <div class="post-meta">






<span title='2025-11-09 10:57:37.196 +0000 UTC'>2025-11-09</span>&nbsp;·&nbsp;<span title='2025-11-15 16:03:38.489099811 +0000 UTC'>(最后修改于 2025-11-15)</span>&nbsp;·&nbsp;<span>15 分钟</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90" aria-label="需求分析：">需求分析：</a></li>
                <li>
                    <a href="#%e6%8a%80%e6%9c%af%e9%80%89%e5%9e%8b" aria-label="技术选型">技术选型</a></li>
                <li>
                    <a href="#%e6%80%9d%e8%b7%af%e5%88%86%e6%9e%90" aria-label="思路分析">思路分析</a><ul>
                        
                <li>
                    <a href="#1-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e9%a1%b9%e7%9b%ae%e6%a8%a1%e5%9d%97chat-system" aria-label="1. 创建一个项目模块：chat-system">1. 创建一个项目模块：chat-system</a></li>
                <li>
                    <a href="#2-%e7%bc%96%e5%86%99%e7%b3%bb%e7%bb%9f%e7%95%8c%e9%9d%a2swing%e4%bb%a3%e7%a0%81" aria-label="2. 编写系统界面：Swing代码">2. 编写系统界面：Swing代码</a></li>
                <li>
                    <a href="#3-%e5%ae%9a%e4%b9%89%e4%b8%80%e4%b8%aaapp%e5%90%af%e5%8a%a8%e7%b1%bb%e5%88%9b%e5%bb%ba%e8%bf%9b%e5%85%a5%e7%95%8c%e9%9d%a2%e5%af%b9%e8%b1%a1%e5%b9%b6%e5%b1%95%e7%a4%ba" aria-label="3. 定义一个App启动类：创建进入界面对象并展示">3. 定义一个App启动类：创建进入界面对象并展示</a></li>
                <li>
                    <a href="#4-%e5%88%86%e6%9e%90%e7%b3%bb%e7%bb%9f%e6%95%b4%e4%bd%93%e6%9e%b6%e6%9e%84" aria-label="4. 分析系统整体架构">4. 分析系统整体架构</a></li>
                <li>
                    <a href="#5-%e5%85%88%e5%bc%80%e5%8f%91%e5%ae%8c%e6%95%b4%e7%9a%84%e6%9c%8d%e5%8a%a1%e7%ab%af" aria-label="5. 先开发完整的服务端">5. 先开发完整的服务端</a></li>
                <li>
                    <a href="#6%e5%ae%8c%e5%96%84%e5%ae%a2%e6%88%b7%e7%ab%af%e7%a8%8b%e5%ba%8f%e4%bb%a3%e7%a0%81" aria-label="6.完善客户端程序代码">6.完善客户端程序代码</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%88%90%e5%93%81%e5%b1%95%e7%a4%ba" aria-label="成品展示">成品展示</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%b1%95%e7%a4%ba" aria-label="代码展示">代码展示</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="需求分析">需求分析：<a hidden class="anchor" aria-hidden="true" href="#需求分析">#</a></h2>
<ul>
<li>一个用户的登录界面，输入昵称</li>
<li>群聊窗口
<ul>
<li>展示在线人数（实时更新）</li>
<li>消息展示框</li>
<li>消息输入框</li>
<li>发送按钮</li>
</ul>
</li>
<li>群聊功能</li>
</ul>
<h2 id="技术选型">技术选型<a hidden class="anchor" aria-hidden="true" href="#技术选型">#</a></h2>
<ul>
<li>GUI编程技术：<strong>Swing</strong></li>
<li>网络编程</li>
<li>OOP面对对象设计</li>
<li>一些常用的API</li>
</ul>
<h2 id="思路分析">思路分析<a hidden class="anchor" aria-hidden="true" href="#思路分析">#</a></h2>
<h3 id="1-创建一个项目模块chat-system">1. 创建一个项目模块：<code>chat-system</code><a hidden class="anchor" aria-hidden="true" href="#1-创建一个项目模块chat-system">#</a></h3>
<p><img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/1.png"></p>
<h3 id="2-编写系统界面swing代码">2. 编写系统界面：Swing代码<a hidden class="anchor" aria-hidden="true" href="#2-编写系统界面swing代码">#</a></h3>
<ul>
<li>登录界面：要求用户输入自己的昵称
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.itheima.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ChatEntryFrame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">JFrame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kd">private</span><span class="w"> </span><span class="n">JTextField</span><span class="w"> </span><span class="n">nicknameField</span><span class="p">;</span><span class="c1">//昵称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kd">private</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">enterButton</span><span class="p">;</span><span class="c1">//确定</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kd">private</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">cancelButton</span><span class="p">;</span><span class="c1">//取消</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="nf">ChatEntryFrame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="c1">//构造方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">setTitle</span><span class="p">(</span><span class="s">&#34;局域网聊天室&#34;</span><span class="p">);</span><span class="c1">//标题</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">setSize</span><span class="p">(</span><span class="n">350</span><span class="p">,</span><span class="w"> </span><span class="n">200</span><span class="p">);</span><span class="c1">//大小</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">setLocationRelativeTo</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="c1">//居中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span><span class="c1">//退出程序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">setResizable</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="c1">//不可缩放</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//设置背景颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">getContentPane</span><span class="p">().</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//创建主面板并设置布局</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">JPanel</span><span class="w"> </span><span class="n">mainPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">add</span><span class="p">(</span><span class="n">mainPanel</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//创建顶部面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">JPanel</span><span class="w"> </span><span class="n">topPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w">  </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">,</span><span class="n">10</span><span class="p">,</span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">topPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//标签和文本框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">JLabel</span><span class="w"> </span><span class="n">nicknameLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JLabel</span><span class="p">(</span><span class="s">&#34;昵称：&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">nicknameLabel</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">nicknameField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextField</span><span class="p">(</span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="n">Font</span><span class="p">.</span><span class="na">PLAIN</span><span class="p">,</span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createCompoundBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createMatteBorder</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">Color</span><span class="p">.</span><span class="na">GRAY</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="n">5</span><span class="p">,</span><span class="n">5</span><span class="p">,</span><span class="n">5</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">topPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">nicknameLabel</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">topPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">nicknameField</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">topPanel</span><span class="p">,</span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">NORTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//按钮面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">JPanel</span><span class="w"> </span><span class="n">buttonPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">,</span><span class="n">10</span><span class="p">,</span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;确定&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;取消&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF44336</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">enterButton</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">cancelButton</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">buttonPanel</span><span class="p">,</span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="c1">//添加监听</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">enterButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">nickname</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="c1">//进入聊天室</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="n">dispose</span><span class="p">();</span><span class="c1">//销毁当前窗口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="n">JOptionPane</span><span class="p">.</span><span class="na">showMessageDialog</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="s">&#34;请输入昵称！&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">System</span><span class="p">.</span><span class="na">exit</span><span class="p">(</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">});</span><span class="c1">//退出程序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="c1">//显示</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="k">new</span><span class="w"> </span><span class="n">ChatEntryFrame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>聊天界面：
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.itheima.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClientChatFrame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">JFrame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JTextArea</span><span class="w"> </span><span class="n">smsContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextArea</span><span class="p">(</span><span class="n">23</span><span class="p">,</span><span class="w"> </span><span class="n">50</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JTextArea</span><span class="w"> </span><span class="n">smsSend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextArea</span><span class="p">(</span><span class="n">4</span><span class="p">,</span><span class="w"> </span><span class="n">40</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">userList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">btnSend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;发送&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ClientChatFrame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">initView</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initView</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置窗口基本属性</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span><span class="n">800</span><span class="p">,</span><span class="w"> </span><span class="n">600</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setLayout</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w"> </span><span class="c1">// 添加组件间距</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setLocationRelativeTo</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="c1">//居中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置窗口背景颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">getContentPane</span><span class="p">().</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置字体</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Font</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">PLAIN</span><span class="p">,</span><span class="w"> </span><span class="n">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Font</span><span class="w"> </span><span class="n">boldFont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="w"> </span><span class="n">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 消息内容框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setEditable</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setLineWrap</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setWrapStyleWord</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 发送消息框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setWrapStyleWord</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setLineWrap</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createCompoundBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 创建底部面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">bottomPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 消息输入框滚动面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">smsSendScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">smsSend</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSendScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSendScrollPanel</span><span class="p">.</span><span class="na">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">JScrollPane</span><span class="p">.</span><span class="na">VERTICAL_SCROLLBAR_AS_NEEDED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 发送按钮</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">boldFont</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setCursor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Cursor</span><span class="p">(</span><span class="n">Cursor</span><span class="p">.</span><span class="na">HAND_CURSOR</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setPreferredSize</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Dimension</span><span class="p">(</span><span class="n">80</span><span class="p">,</span><span class="w"> </span><span class="n">40</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 按钮面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">btnsPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnsPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnsPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">btnSend</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 添加底部组件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsSendScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">btnsPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setSelectionBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setSelectionForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 用户列表面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">userListPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createTitledBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;在线用户&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">boldFont</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">userListScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">userList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">userListScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setPreferredSize</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Dimension</span><span class="p">(</span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 中心消息面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">smsContentPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createTitledBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;消息记录&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">boldFont</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">smsContentScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">smsContent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentScrollPanel</span><span class="p">.</span><span class="na">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">JScrollPane</span><span class="p">.</span><span class="na">VERTICAL_SCROLLBAR_ALWAYS</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsContentScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 添加组件到主窗口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsContentPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">userListPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">EAST</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">bottomPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ClientChatFrame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
<h3 id="3-定义一个app启动类创建进入界面对象并展示">3. 定义一个App启动类：创建进入界面对象并展示<a hidden class="anchor" aria-hidden="true" href="#3-定义一个app启动类创建进入界面对象并展示">#</a></h3>
<h3 id="4-分析系统整体架构">4. 分析系统整体架构<a hidden class="anchor" aria-hidden="true" href="#4-分析系统整体架构">#</a></h3>
<p><a href="/images/java-se/project/demo/tcp-chat-gui/2.png"><img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/2.png"></a></p>
<ol>
<li>开发服务端：
<ul>
<li>接受客户端的管道连接</li>
<li>接受登录消息，接受昵称信息</li>
<li>服务端也可能接受客户端发送的群聊消息</li>
<li>存储所有在线的socket管道。查看在线状态、转发消息</li>
<li>收到登录消息<code>-&gt;</code>接受昵称<code>-&gt;</code>更新在线状态</li>
<li>收到群聊消息<code>-&gt;</code>接受消息<code>-&gt;</code>转发给所有客户端</li>
</ul>
</li>
<li>客户端：在原本的基础上进行完善</li>
</ol>
<h3 id="5-先开发完整的服务端">5. 先开发完整的服务端<a hidden class="anchor" aria-hidden="true" href="#5-先开发完整的服务端">#</a></h3>
<ul>
<li>第一步、创建一个服务端的项目模块：<code>chat-server</code>
<img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/3.png"></li>
<li>第二步、创建一个服务器启动类，启动服务器等待客户端的连接
<a href="/images/java-se/project/demo/tcp-chat-gui/4.png"><img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/4.png"></a>
尽量贴近实战开发，所以此处的端口<code>port</code>不写死，用常量池<code>Constant</code>定义常量，方便后续维护
<img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/5.png"></li>
<li>第三步、把<code>socket</code>管道交给一个独立的子线程来处理，以支持多客户端即时通信
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.ServerSocket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Server</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;===启动服务端===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//1.注册端口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">ServerSocket</span><span class="w"> </span><span class="n">serverSocket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ServerSocket</span><span class="p">(</span><span class="n">Constant</span><span class="p">.</span><span class="na">PORT</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.主线程循环监听</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//3.调用accept()方法，阻塞等待客户端连接，连接成功返回一个Socket对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;等待客户端连接...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">ServerReaderThread</span><span class="p">(</span><span class="n">socket</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;一个客户端上线了&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
<li>第四步、定义一个集合容器存储所有在线客户端
<ul>
<li>这个集合只需要一个
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//定义一个集合容器存储所有上线的在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//定义一个Map集合，键：Socket对象，值：用户名</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Socket</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLineSockets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
</li>
<li>第五步、服务端线程接受登录消息/群聊消息</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//所以客户端必须声明协议发送消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//比如客户端先发送一个数字1，表示登录消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字2表示群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字3表示私聊消息</span><span class="w">
</span></span></span></code></pre></div><p>先接受一个整数，进行判断，然后执行逻辑</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ServerReaderThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ServerReaderThread</span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//所以客户端必须声明协议发送消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//比如客户端先发送一个数字1，表示登录消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字2表示群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字3表示私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//先从管道读取数字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//登录消息，更新在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//群聊消息，读取消息内容，发送给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//私聊消息，读取消息内容，发送给指定用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;客户端下线了：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="na">getInetAddress</span><span class="p">().</span><span class="na">getHostAddress</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>第六步、实现服务端的登录消息接收</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataOutputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collection</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ServerReaderThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ServerReaderThread</span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//所以客户端必须声明协议发送消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//比如客户端先发送一个数字1，表示登录消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字2表示群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字3表示私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字4表示退出登录/下线消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//先从管道读取数字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//登录消息，更新在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">nickName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//把昵称保存到在线集合中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//发送在线用户列表给所有用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//群聊消息，读取消息内容，发送给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//私聊消息，读取消息内容，发送给指定用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;客户端下线了：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="na">getInetAddress</span><span class="p">().</span><span class="na">getHostAddress</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">socket</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateClientOnlineUserList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//更新全部客户端的在线人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.拿到全部在线用户名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onlineUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">values</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.把用户名称发送给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">keySet</span><span class="p">()){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="c1">//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">onlineUsers</span><span class="p">.</span><span class="na">size</span><span class="p">());</span><span class="c1">//告诉客户端，本次登录的用户数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">onlineUser</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">onlineUsers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">onlineUser</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="c1">//刷新管道,立即发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>第七步、接收客户端的群聊消息
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataOutputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.time.format.DateTimeFormatter</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collection</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ServerReaderThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ServerReaderThread</span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//所以客户端必须声明协议发送消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//比如客户端先发送一个数字1，表示登录消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字2表示群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字3表示私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字4表示退出登录/下线消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//先从管道读取数字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//登录消息，更新在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">nickName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//把昵称保存到在线集合中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//发送在线用户列表给所有用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//群聊消息，读取消息内容，发送给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">sendMsgToAll</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//私聊消息，读取消息内容，发送给指定用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;客户端下线了：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="na">getInetAddress</span><span class="p">().</span><span class="na">getHostAddress</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">socket</span><span class="p">);</span><span class="c1">//移除下线的用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="c1">//刷新在线人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//发送群聊消息给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sendMsgToAll</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//拼装好这个消息再发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">socket</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DateTimeFormatter</span><span class="w"> </span><span class="n">dtf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&#34;yyyy-MM-dd HH:mm:ss EEE a&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">nowStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtf</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">now</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">msgResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">name</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="n">nowStr</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34;\r\n&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34;\r\n&#34;</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.把消息发送给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">2</span><span class="p">);</span><span class="c1">//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">msgResult</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="c1">//刷新管道,立即发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateClientOnlineUserList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//更新全部客户端的在线人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.拿到全部在线用户名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onlineUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">values</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.把用户名称发送给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">keySet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="c1">//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">onlineUsers</span><span class="p">.</span><span class="na">size</span><span class="p">());</span><span class="c1">//告诉客户端，本次登录的用户数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">onlineUser</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">onlineUsers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">onlineUser</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="c1">//刷新管道,立即发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div></li>
</ul>
<h3 id="6完善客户端程序代码">6.完善客户端程序代码<a hidden class="anchor" aria-hidden="true" href="#6完善客户端程序代码">#</a></h3>
<ul>
<li>
<p>第一步、完善登录界面</p>
<p>为进入按钮绑定点击事件监听器，点击后获取昵称，请求与服务器端的socket管道连接<code>-&gt;</code>发送'1&rsquo;<code>-&gt;</code>发送昵称<code>-&gt;</code>进入界面<code>-&gt;</code>接收socket管道</p>
</li>
<li>
<p>第二步、读取客户端socket管道从发u五点发来的在线人数更新消息/群聊消息</p>
<ul>
<li>创建一个独立的线程负责读取客户端socket从服务端收取的数据（人数更新/消息数据）</li>
<li>收到消息后，进行判断，根据消息类型分类处理</li>
</ul>
</li>
<li>
<p>第三步、接收群聊消息</p>
<ul>
<li>接收消息类型<code>2</code> <code>-&gt;</code> 接收群聊数据<code>-&gt;</code>展示到界面</li>
</ul>
</li>
<li>
<p>第四步、发送群聊消息</p>
<ul>
<li>为发送按钮绑定一个点击事件，获取输入框的消息内容<code>-&gt;</code>发送<code>2</code> <code>-&gt;</code> 发送消息<code>-&gt;</code>更新消息框</li>
</ul>
</li>
</ul>
<h2 id="成品展示">成品展示<a hidden class="anchor" aria-hidden="true" href="#成品展示">#</a></h2>
<p><img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/6.png">
<img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/7.png">
<img loading="lazy" src="/images/java-se/project/demo/tcp-chat-gui/8.png"></p>
<h2 id="代码展示">代码展示<a hidden class="anchor" aria-hidden="true" href="#代码展示">#</a></h2>
<pre tabindex="0"><code class="language-tree" data-lang="tree">├─chat-server
│  │  chat-server.iml
│  │  
│  └─src
│      └─com
│          └─localchat
│                  Constant.java
│                  Server.java
│                  ServerReaderThread.java
│                  
├─chat-system
│  │  chat-system.iml
│  │  
│  └─src
│      │  App.java
│      │  
│      └─com
│          └─localchat
│              └─ui
│                      ChatEntryFrame.java
│                      ClientChatFrame.java
│                      ClientReaderThread.java
│                      Constant.java
</code></pre><p><code>Constant.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Constant</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w">  </span><span class="n">PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">8888</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>Server.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.ServerSocket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.HashMap</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Server</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//定义一个集合容器存储所有上线的在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//定义一个Map集合，键：Socket对象，值：用户名</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Socket</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLineSockets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;===启动服务端===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//1.注册端口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">ServerSocket</span><span class="w"> </span><span class="n">serverSocket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ServerSocket</span><span class="p">(</span><span class="n">Constant</span><span class="p">.</span><span class="na">PORT</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.主线程循环监听</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//3.调用accept()方法，阻塞等待客户端连接，连接成功返回一个Socket对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;等待客户端连接...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">serverSocket</span><span class="p">.</span><span class="na">accept</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//                把socket管道交给一个独立的子线程来处理，以支持多客户端即时通信</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">ServerReaderThread</span><span class="p">(</span><span class="n">socket</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;一个客户端上线了&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>ServerReaderThread.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataOutputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.time.format.DateTimeFormatter</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collection</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ServerReaderThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ServerReaderThread</span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//消息类型：1.登录消息（包含昵称）2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//所以客户端必须声明协议发送消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//比如客户端先发送一个数字1，表示登录消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字2表示群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字3表示私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//数字4表示退出登录/下线消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//先从管道读取数字</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//登录消息，更新在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">nickName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//把昵称保存到在线集合中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">nickName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//发送在线用户列表给所有用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//群聊消息，读取消息内容，发送给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">sendMsgToAll</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//私聊消息，读取消息内容，发送给指定用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;客户端下线了：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="na">getInetAddress</span><span class="p">().</span><span class="na">getHostAddress</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">socket</span><span class="p">);</span><span class="c1">//移除下线的用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="c1">//刷新在线人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//发送群聊消息给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sendMsgToAll</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//拼装好这个消息再发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">socket</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DateTimeFormatter</span><span class="w"> </span><span class="n">dtf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&#34;yyyy-MM-dd HH:mm:ss EEE a&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">nowStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtf</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">now</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">msgResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">name</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="n">nowStr</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34;\r\n&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="na">append</span><span class="p">(</span><span class="s">&#34;\r\n&#34;</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.把消息发送给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">keySet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">2</span><span class="p">);</span><span class="c1">//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">msgResult</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="c1">//刷新管道,立即发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateClientOnlineUserList</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//更新全部客户端的在线人数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//拿到全部在线客户端的用户名称，把这些名称转发给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.拿到全部在线用户名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onlineUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">values</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.把用户名称发送给全部在线socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Server</span><span class="p">.</span><span class="na">onLineSockets</span><span class="p">.</span><span class="na">keySet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="c1">//1：告诉客户端，这是在线人数列表，2：群聊消息，3：私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">onlineUsers</span><span class="p">.</span><span class="na">size</span><span class="p">());</span><span class="c1">//告诉客户端，本次登录的用户数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">onlineUser</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">onlineUsers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">onlineUser</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="c1">//刷新管道,立即发送</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>ChatEntryFrame.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataOutputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ChatEntryFrame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">JFrame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JTextField</span><span class="w"> </span><span class="n">nicknameField</span><span class="p">;</span><span class="c1">//昵称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">enterButton</span><span class="p">;</span><span class="c1">//确定</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">cancelButton</span><span class="p">;</span><span class="c1">//取消</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ChatEntryFrame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="c1">//构造方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setTitle</span><span class="p">(</span><span class="s">&#34;局域网聊天室&#34;</span><span class="p">);</span><span class="c1">//标题</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setSize</span><span class="p">(</span><span class="n">350</span><span class="p">,</span><span class="w"> </span><span class="n">200</span><span class="p">);</span><span class="c1">//大小</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setLocationRelativeTo</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="c1">//居中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span><span class="c1">//退出程序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setResizable</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="c1">//不可缩放</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//设置背景颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">getContentPane</span><span class="p">().</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建主面板并设置布局</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">mainPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">add</span><span class="p">(</span><span class="n">mainPanel</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建顶部面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">topPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">topPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//标签和文本框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JLabel</span><span class="w"> </span><span class="n">nicknameLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JLabel</span><span class="p">(</span><span class="s">&#34;昵称：&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nicknameLabel</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nicknameField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextField</span><span class="p">(</span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">PLAIN</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createCompoundBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createMatteBorder</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">GRAY</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">)));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">topPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">nicknameLabel</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">topPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">nicknameField</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">topPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">NORTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//按钮面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">buttonPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF0F0F0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;登录&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;取消&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xF44336</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">enterButton</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">buttonPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">cancelButton</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mainPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">buttonPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//添加监听</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">enterButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span><span class="c1">//获取昵称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">nicknameField</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span><span class="c1">//清空文本框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">nickname</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//发送登录消息给服务器端</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">login</span><span class="p">(</span><span class="n">nickname</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//进入聊天室</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">ClientChatFrame</span><span class="p">(</span><span class="n">nickname</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ex</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">dispose</span><span class="p">();</span><span class="c1">//销毁当前窗口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">JOptionPane</span><span class="p">.</span><span class="na">showMessageDialog</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;请输入昵称！&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cancelButton</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">exit</span><span class="p">(</span><span class="n">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="c1">//退出程序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="c1">//显示</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.创建socket管道</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Socket</span><span class="p">(</span><span class="n">Constant</span><span class="p">.</span><span class="na">SERVER_IP</span><span class="p">,</span><span class="w"> </span><span class="n">Constant</span><span class="p">.</span><span class="na">SERVER_PORT</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.获取输出流，发送登录消息给服务器端</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="c1">//消息类型：1：登录</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">nickname</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ChatEntryFrame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>ClientChatFrame.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">javax.swing.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.awt.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataOutputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClientChatFrame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">JFrame</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JTextArea</span><span class="w"> </span><span class="n">smsContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextArea</span><span class="p">(</span><span class="n">23</span><span class="p">,</span><span class="w"> </span><span class="n">50</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JTextArea</span><span class="w"> </span><span class="n">smsSend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JTextArea</span><span class="p">(</span><span class="n">4</span><span class="p">,</span><span class="w"> </span><span class="n">40</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">userList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">JButton</span><span class="w"> </span><span class="n">btnSend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">(</span><span class="s">&#34;发送&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ClientChatFrame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">initView</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ClientChatFrame</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="p">,</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">();</span><span class="c1">//调用无参构造方法，初始化界面</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//初始化数据</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//把昵称展示到标题中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setTitle</span><span class="p">(</span><span class="n">nickname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;的聊天窗口&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nickname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//启动线程，接收服务端发送的消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ClientReaderThread</span><span class="p">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initView</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置窗口基本属性</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span><span class="n">800</span><span class="p">,</span><span class="w"> </span><span class="n">600</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setLayout</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w"> </span><span class="c1">// 添加组件间距</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setLocationRelativeTo</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="c1">//居中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">setDefaultCloseOperation</span><span class="p">(</span><span class="n">JFrame</span><span class="p">.</span><span class="na">EXIT_ON_CLOSE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置窗口背景颜色</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">getContentPane</span><span class="p">().</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置字体</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Font</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">PLAIN</span><span class="p">,</span><span class="w"> </span><span class="n">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Font</span><span class="w"> </span><span class="n">boldFont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Font</span><span class="p">.</span><span class="na">BOLD</span><span class="p">,</span><span class="w"> </span><span class="n">14</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 消息内容框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setEditable</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setLineWrap</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setWrapStyleWord</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 发送消息框</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setWrapStyleWord</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setLineWrap</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createCompoundBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 创建底部面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">bottomPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 消息输入框滚动面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">smsSendScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">smsSend</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSendScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsSendScrollPanel</span><span class="p">.</span><span class="na">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">JScrollPane</span><span class="p">.</span><span class="na">VERTICAL_SCROLLBAR_AS_NEEDED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 发送按钮</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">boldFont</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setBorderPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setFocusPainted</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setCursor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Cursor</span><span class="p">(</span><span class="n">Cursor</span><span class="p">.</span><span class="na">HAND_CURSOR</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">setPreferredSize</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Dimension</span><span class="p">(</span><span class="n">80</span><span class="p">,</span><span class="w"> </span><span class="n">40</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 按钮面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">btnsPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FlowLayout</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnsPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnsPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">btnSend</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 给发送按钮添加点击监听器</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">btnSend</span><span class="p">.</span><span class="na">addActionListener</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smsSend</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">smsSend</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">sendMsgToServer</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 添加底部组件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsSendScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">bottomPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">btnsPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setSelectionBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0x4CAF50</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setSelectionForeground</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">WHITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 用户列表面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">userListPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createTitledBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;在线用户&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">boldFont</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">userListScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">userList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">userListScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userListPanel</span><span class="p">.</span><span class="na">setPreferredSize</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Dimension</span><span class="p">(</span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 中心消息面板</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JPanel</span><span class="w"> </span><span class="n">smsContentPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JPanel</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">setBackground</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">,</span><span class="w"> </span><span class="n">0xf5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createTitledBorder</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createLineBorder</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">,</span><span class="w"> </span><span class="n">0xcc</span><span class="p">)),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;消息记录&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">boldFont</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JScrollPane</span><span class="w"> </span><span class="n">smsContentScrollPanel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JScrollPane</span><span class="p">(</span><span class="n">smsContent</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentScrollPanel</span><span class="p">.</span><span class="na">setBorder</span><span class="p">(</span><span class="n">BorderFactory</span><span class="p">.</span><span class="na">createEmptyBorder</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentScrollPanel</span><span class="p">.</span><span class="na">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">JScrollPane</span><span class="p">.</span><span class="na">VERTICAL_SCROLLBAR_ALWAYS</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContentPanel</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsContentScrollPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 添加组件到主窗口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">smsContentPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">userListPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">EAST</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">bottomPanel</span><span class="p">,</span><span class="w"> </span><span class="n">BorderLayout</span><span class="p">.</span><span class="na">SOUTH</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sendMsgToServer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.从socket管道中获取输出流</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">DataOutputStream</span><span class="w"> </span><span class="n">dos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataOutputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.发送消息给服务端</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">writeInt</span><span class="p">(</span><span class="n">2</span><span class="p">);</span><span class="c1">//消息类型：2：群聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">writeUTF</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ClientChatFrame</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateOnlineUsers</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">onLineNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//把这个线程读取到的在线用户更新到界面上</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userList</span><span class="p">.</span><span class="na">setListData</span><span class="p">(</span><span class="n">onLineNames</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//添加消息到界面</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setMsgToWin</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//把消息添加到界面中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">smsContent</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>ClientReaderThread.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.DataInputStream</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.Socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClientReaderThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DataInputStream</span><span class="w"> </span><span class="n">dis</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ClientChatFrame</span><span class="w"> </span><span class="n">win</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ClientReaderThread</span><span class="p">(</span><span class="n">Socket</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">ClientChatFrame</span><span class="w"> </span><span class="n">win</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">socket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">win</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">win</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//消息类型：1.在线人数更新2.群聊消息3.私聊消息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">dis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataInputStream</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="c1">//1，2，3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//登录消息，更新在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">updateClientOnlineUserList</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">2</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//群聊消息，读取消息内容，发送给所有在线用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">getMsgToWin</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="n">3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="c1">//私聊消息，读取消息内容，发送给指定用户</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">getMsgToWin</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.读取消息内容</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">win</span><span class="p">.</span><span class="na">setMsgToWin</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//更新客户端在线用户列表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateClientOnlineUserList</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.读取有多少个在线用户信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readInt</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.循环读取用户信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">onLineNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="n">count</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//3.读取一个用户信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">nickname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dis</span><span class="p">.</span><span class="na">readUTF</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//4.把用户信息添加到集合中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">onLineNames</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nickname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">win</span><span class="p">.</span><span class="na">updateOnlineUsers</span><span class="p">(</span><span class="n">onLineNames</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>Constant.java</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.localchat.ui</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Constant</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">SERVER_IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;127.0.0.1&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w">  </span><span class="n">SERVER_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">8888</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.steamedfish.top/tags/gui/">GUI</a></li>
      <li><a href="https://www.steamedfish.top/tags/java/">Java</a></li>
      <li><a href="https://www.steamedfish.top/tags/oop/">OOP</a></li>
      <li><a href="https://www.steamedfish.top/tags/swing/">Swing</a></li>
      <li><a href="https://www.steamedfish.top/tags/%E5%AE%9E%E6%88%98demo/">实战Demo</a></li>
      <li><a href="https://www.steamedfish.top/tags/java-se/">Java SE</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://www.steamedfish.top/">©2025 SteamedFish&rsquo;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
