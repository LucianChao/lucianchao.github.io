<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>【苍穹外卖】（6）HttpClient及微信登录 | SteamedFish&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="HttpClient
介绍
HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。






    


       
    




  
    
  
    
  




HttpClient作用：

发送HTTP请求
接收响应数据

应用场景：






    


       
    




  
    
  
    
  




效果展示：
百度地图地理编码服务接口：
https://api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号&amp;output=json&amp;ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM






    


       
    




  
    
  
    
  




通过浏览器请求服务的步骤：">
<meta name="author" content="">
<link rel="canonical" href="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-7/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.c27e1246cb66d388c2c28ba2cad7d8e45b296bdd6da67c05cf15ef27e74594b2.css" integrity="sha256-wn4SRstm04jCwouiytfY5Fspa91tpnwFzxXvJ&#43;dFlLI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.steamedfish.top/favicon.png">
<link rel="apple-touch-icon" href="https://www.steamedfish.top/favicon.png">
<link rel="mask-icon" href="https://www.steamedfish.top/favicon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-7/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>





<link
  href="/fonts/lxgw/style.css"
  rel="stylesheet"
/><meta property="og:url" content="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-7/">
  <meta property="og:site_name" content="SteamedFish&#39;s Blog">
  <meta property="og:title" content="【苍穹外卖】（6）HttpClient及微信登录">
  <meta property="og:description" content="HttpClient 介绍 HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。 HttpClient作用：
发送HTTP请求 接收响应数据 应用场景： 效果展示： 百度地图地理编码服务接口：
https://api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号&amp;output=json&amp;ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM 通过浏览器请求服务的步骤：">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-12-23T21:49:59+08:00">
    <meta property="article:modified_time" content="2025-12-24T02:27:30+08:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【苍穹外卖】（6）HttpClient及微信登录">
<meta name="twitter:description" content="HttpClient
介绍
HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。






    


       
    




  
    
  
    
  




HttpClient作用：

发送HTTP请求
接收响应数据

应用场景：






    


       
    




  
    
  
    
  




效果展示：
百度地图地理编码服务接口：
https://api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号&amp;output=json&amp;ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM






    


       
    




  
    
  
    
  




通过浏览器请求服务的步骤：">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.steamedfish.top/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "【苍穹外卖】（6）HttpClient及微信登录",
      "item": "https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-7/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【苍穹外卖】（6）HttpClient及微信登录",
  "name": "【苍穹外卖】（6）HttpClient及微信登录",
  "description": "HttpClient 介绍 HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。 HttpClient作用：\n发送HTTP请求 接收响应数据 应用场景： 效果展示： 百度地图地理编码服务接口：\nhttps://api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号\u0026amp;output=json\u0026amp;ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM 通过浏览器请求服务的步骤：\n",
  "keywords": [
    
  ],
  "articleBody": "HttpClient 介绍 HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。 HttpClient作用：\n发送HTTP请求 接收响应数据 应用场景： 效果展示： 百度地图地理编码服务接口：\nhttps://api.map.baidu.com/geocoding/v3/?address=北京市海淀区上地十街10号\u0026output=json\u0026ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM 通过浏览器请求服务的步骤：\n构造请求地址和参数 发送请求 接收数据 入门案例 需求1：通过HttpClient发送get请求，请求苍穹外卖用户端的查看店铺营业状态接口。/user/shop/status 需求2：通过HttpClient发送post请求，请求苍穹外卖管理端的员工登录接口。/admin/employee/login\n导入依赖 发送请求步骤： 创建HttpClient对象 核心API： HttpClient HttpClients CloseableHttpClient HttpGet HttpPost 创建Http请求对象 调用HttpClient的execute方法发送请求 微信小程序开发 介绍 官网： https://mp.weixin.qq.com/cgi-bin/wx?token=\u0026lang=zh_CN 准备工作 开发微信小程序之前需要做如下准备工作：\n注册小程序 完善小程序信息 下载开发者工具 注册地址：https://mp.weixin.qq.com/wxopen/waregister?action=step1 登录小程序后台：https://mp.weixin.qq.com/ 完善小程序信息、小程序类目 查看小程序的 AppID 下载地址： https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html 扫描登录开发者工具 创建小程序项目 开发者工具布局 设置不校验合法域名 入门案例 操作步骤：\n了解小程序目录结构\n小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。\n一个小程序主体部分由三个文件组成，必须放在项目的根目录，如下： 一个小程序页面由四个文件组成： 编写小程序代码 编译小程序 微信登录功能 导入小程序代码 微信登录流程 微信登录： https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html 信息\n可以使用postman/Apifox测试登录凭证校验接口\n步骤分析：\n小程序端，调用wx.login()获取code，就是授权码。 小程序端，调用wx.request()发送请求并携带code，请求开发者服务器(自己编写的后端服务)。 开发者服务端，通过HttpClient向微信接口服务发送请求，并携带appId+appsecret+code三个参数。 开发者服务端，接收微信接口服务返回的数据，session_key+opendId等。opendId是微信用户的唯一标识。 开发者服务端，自定义登录态，生成令牌(token)和openid等数据返回给小程序端，方便后绪请求身份校验。 小程序端，收到自定义登录态，存储到storage。 小程序端，后续通过wx.request()发起业务请求时，携带token。 开发者服务端，收到请求后，通过携带的token，解析当前登录用户的id。 开发者服务端，身份校验通过后，继续相关的业务逻辑处理，最终返回业务数据。 需求分析和设计 产品原型： 业务规则：\n基于微信登录实现小程序的登录功能 如果是新用户需要自动完成注册 接口设计： 数据量设计（user表）： 代码开发 配置微信登录所需配置项： 配置为微信用户生成jwt令牌时使用的配置项： DTO设计： VO设计： 根据接口定义创建UserController的login方法： 完善UserController的login方法： 创建UserService接口： 创建UserServiceImpl实现类： 在UserServiceImpl中创建私有方法getOpenid： 完善UserServiceImpl的wxLogin方法： 完善UserServiceImpl的wxLogin方法： 创建UserMapper接口： 创建UserMapper.xml映射文件： 编写拦截器JwtTokenUserInterceptor，统一拦截用户端发送的请求并进行jwt校验： 在WebMvcConfiguration配置类中注册拦截器： 商品浏览功能代码 需求分析和设计 产品原型： 接口设计：\n查询分类 根据分类id查询菜品 根据分类id查询套餐 根据套餐id查询包含的菜品 ",
  "wordCount" : "1687",
  "inLanguage": "zh",
  "datePublished": "2025-12-23T21:49:59+08:00",
  "dateModified": "2025-12-24T02:27:30+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-7/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SteamedFish's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.steamedfish.top/favicon.png"
    }
  }
}
</script>
</head>

<body data-barba="wrapper" class="" id="top">

<div id="aplayer"></div>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.steamedfish.top/" accesskey="h" title="SteamedFish&#39;s Blog (Alt + H)">SteamedFish&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="https://www.steamedfish.top/en/" title="English"
                                aria-label="English">En</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.steamedfish.top/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main" data-barba="container" data-barba-namespace="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      【苍穹外卖】（6）HttpClient及微信登录
    </h1>
    <div class="post-meta">






<span title='2025-12-23 21:49:59 +0800 +0800'>2025-12-23</span>&nbsp;·&nbsp;<span title='2025-12-24 02:27:30 +0800 +0800'>(最后修改于 2025-12-24)</span>&nbsp;·&nbsp;<span>4 分钟</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#httpclient" aria-label="HttpClient">HttpClient</a><ul>
                        
                <li>
                    <a href="#%e4%bb%8b%e7%bb%8d" aria-label="介绍">介绍</a></li>
                <li>
                    <a href="#%e5%85%a5%e9%97%a8%e6%a1%88%e4%be%8b" aria-label="入门案例">入门案例</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%be%ae%e4%bf%a1%e5%b0%8f%e7%a8%8b%e5%ba%8f%e5%bc%80%e5%8f%91" aria-label="微信小程序开发">微信小程序开发</a><ul>
                        
                <li>
                    <a href="#%e4%bb%8b%e7%bb%8d-1" aria-label="介绍">介绍</a></li>
                <li>
                    <a href="#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c" aria-label="准备工作">准备工作</a></li>
                <li>
                    <a href="#%e5%85%a5%e9%97%a8%e6%a1%88%e4%be%8b-1" aria-label="入门案例">入门案例</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%be%ae%e4%bf%a1%e7%99%bb%e5%bd%95%e5%8a%9f%e8%83%bd" aria-label="微信登录功能">微信登录功能</a><ul>
                        
                <li>
                    <a href="#%e5%af%bc%e5%85%a5%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%bb%a3%e7%a0%81" aria-label="导入小程序代码">导入小程序代码</a></li>
                <li>
                    <a href="#%e5%be%ae%e4%bf%a1%e7%99%bb%e5%bd%95%e6%b5%81%e7%a8%8b" aria-label="微信登录流程">微信登录流程</a></li>
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91" aria-label="代码开发">代码开发</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%95%86%e5%93%81%e6%b5%8f%e8%a7%88%e5%8a%9f%e8%83%bd%e4%bb%a3%e7%a0%81" aria-label="商品浏览功能代码">商品浏览功能代码</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-1" aria-label="需求分析和设计">需求分析和设计</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="httpclient">HttpClient<a hidden class="anchor" aria-hidden="true" href="#httpclient">#</a></h2>
<h3 id="介绍">介绍<a hidden class="anchor" aria-hidden="true" href="#介绍">#</a></h3>
<p>HttpClient是Apache的一个子项目，是高效的、功能丰富的支持HTTP协议的客户端编程工具包。






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/1.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/1.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/1.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



HttpClient作用：</p>
<ul>
<li><strong>发送HTTP请求</strong></li>
<li><strong>接收响应数据</strong></li>
</ul>
<p>应用场景：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/2.webp"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/2.webp"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/2.webp 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<p>效果展示：
百度地图地理编码服务接口：<br>
<a href="https://api.map.baidu.com/geocoding/v3/?address=">https://api.map.baidu.com/geocoding/v3/?address=</a>北京市海淀区上地十街10号&amp;output=json&amp;ak=UEBQm9c3KZ5LrsO2C2qsOAs1eSdLvlzM






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/3.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/3.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/3.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



通过浏览器请求服务的步骤：</p>
<ol>
<li>构造请求地址和参数</li>
<li>发送请求</li>
<li>接收数据</li>
</ol>
<hr>
<h3 id="入门案例">入门案例<a hidden class="anchor" aria-hidden="true" href="#入门案例">#</a></h3>
<p>需求1：通过HttpClient发送get请求，请求苍穹外卖用户端的查看店铺营业状态接口。<code>/user/shop/status</code>
需求2：通过HttpClient发送post请求，请求苍穹外卖管理端的员工登录接口。<code>/admin/employee/login</code></p>
<ol>
<li>导入依赖






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/4.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/4.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/4.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>发送请求步骤：
<ol>
<li>创建HttpClient对象
<ul>
<li>核心API：
<ul>
<li>HttpClient</li>
<li>HttpClients</li>
<li>CloseableHttpClient</li>
<li>HttpGet</li>
<li>HttpPost</li>
</ul>
</li>
</ul>
</li>
<li>创建Http请求对象</li>
<li>调用HttpClient的execute方法发送请求</li>
</ol>
</li>
</ol>
<hr>
<h2 id="微信小程序开发">微信小程序开发<a hidden class="anchor" aria-hidden="true" href="#微信小程序开发">#</a></h2>
<h3 id="介绍-1">介绍<a hidden class="anchor" aria-hidden="true" href="#介绍-1">#</a></h3>
<p>





    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/5.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/5.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/5.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



官网： <a href="https://mp.weixin.qq.com/cgi-bin/wx?token=&amp;lang=zh_CN">https://mp.weixin.qq.com/cgi-bin/wx?token=&lang=zh_CN</a>






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/6.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/6.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/6.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/7.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/7.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/7.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/8.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/8.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/8.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="准备工作">准备工作<a hidden class="anchor" aria-hidden="true" href="#准备工作">#</a></h3>
<p>开发微信小程序之前需要做如下准备工作：</p>
<ul>
<li>注册小程序</li>
<li>完善小程序信息</li>
<li>下载开发者工具
注册地址：https://mp.weixin.qq.com/wxopen/waregister?action=step1






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/9.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/9.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/9.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



登录小程序后台：https://mp.weixin.qq.com/






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/10.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/10.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/10.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



完善小程序信息、小程序类目






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/11.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/11.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/11.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



查看小程序的 AppID






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/12.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/12.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/12.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



下载地址： <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html">https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html</a>






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/13.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/13.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/13.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



扫描登录开发者工具






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/14.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/14.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/14.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建小程序项目






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/15.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/15.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/15.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



开发者工具布局






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/16.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/16.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/16.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



设置不校验合法域名






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/17.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/17.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/17.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
</ul>
<hr>
<h3 id="入门案例-1">入门案例<a hidden class="anchor" aria-hidden="true" href="#入门案例-1">#</a></h3>
<p>操作步骤：</p>
<ul>
<li>了解小程序目录结构<br>
小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。<br>
一个小程序主体部分由三个文件组成，必须放在项目的根目录，如下：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/18.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/18.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/18.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



一个小程序页面由四个文件组成：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/19.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/19.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/19.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>编写小程序代码






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/20.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/20.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/20.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/21.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/21.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/21.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/22.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/22.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/22.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>编译小程序






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/23.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/23.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/23.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
</ul>
<hr>
<h2 id="微信登录功能">微信登录功能<a hidden class="anchor" aria-hidden="true" href="#微信登录功能">#</a></h2>
<h3 id="导入小程序代码">导入小程序代码<a hidden class="anchor" aria-hidden="true" href="#导入小程序代码">#</a></h3>
<p>





    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/24.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/24.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/24.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<h3 id="微信登录流程">微信登录流程<a hidden class="anchor" aria-hidden="true" href="#微信登录流程">#</a></h3>
<p>微信登录： <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html</a>






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/25.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/25.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/25.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<!-- FM:Snippet:Start data:{"id":"st-notice","fields":[]} -->
<style type="text/css">
     
    .notice {
        --title-color: #fff;
        --title-background-color: #6be;
        --content-color: #444;
        --content-background-color: #e7f2fa;
    }

    .notice.info {
        --title-background-color: #fb7;
        --content-background-color: #fec;
    }

    .notice.tip {
        --title-background-color: #5a5;
        --content-background-color: #efe;
    }

    .notice.warning {
        --title-background-color: #c33;
        --content-background-color: #fee;
    }

     
    

    body.dark .notice {
        --title-color: #fff;
        --title-background-color: #069;
        --content-color: #ddd;
        --content-background-color: #023;
    }

    body.dark .notice.info {
        --title-background-color: #a50;
        --content-background-color: #420;
    }

    body.dark .notice.tip {
        --title-background-color: #363;
        --content-background-color: #121;
    }

    body.dark .notice.warning {
        --title-background-color: #800;
        --content-background-color: #400;
    }

     
    .notice {
        padding: 18px;
        line-height: 24px;
        margin-bottom: 24px;
        border-radius: 4px;
        color: var(--content-color);
        background: var(--content-background-color);
    }

    .notice p:last-child {
        margin-bottom: 0
    }

     
    .notice-title {
        margin: -18px -18px 12px;
        padding: 4px 18px;
        border-radius: 4px 4px 0 0;
        font-weight: 700;
        color: var(--title-color);
        background: var(--title-background-color);
    }

     
    .icon-notice {
        display: inline-flex;
        align-self: center;
        margin-right: 8px;
    }

    .icon-notice img,
    .icon-notice svg {
        height: 1em;
        width: 1em;
        fill: currentColor;
    }

    .icon-notice img,
    .icon-notice.baseline svg {
        top: .125em;
        position: relative;
    }
</style><div class="notice info" >
    <p class="notice-title">
        <span class="icon-notice baseline">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc. --><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
        </span>信息</p><p>可以使用postman/Apifox测试登录凭证校验接口</p></div>
<!-- FM:Snippet:End -->
<p><strong>步骤分析：</strong></p>
<ol>
<li>小程序端，调用wx.login()获取code，就是授权码。</li>
<li>小程序端，调用wx.request()发送请求并携带code，请求开发者服务器(自己编写的后端服务)。</li>
<li>开发者服务端，通过HttpClient向微信接口服务发送请求，并携带appId+appsecret+code三个参数。</li>
<li>开发者服务端，接收微信接口服务返回的数据，session_key+opendId等。opendId是微信用户的唯一标识。</li>
<li>开发者服务端，自定义登录态，生成令牌(token)和openid等数据返回给小程序端，方便后绪请求身份校验。</li>
<li>小程序端，收到自定义登录态，存储到storage。</li>
<li>小程序端，后续通过wx.request()发起业务请求时，携带token。</li>
<li>开发者服务端，收到请求后，通过携带的token，解析当前登录用户的id。</li>
<li>开发者服务端，身份校验通过后，继续相关的业务逻辑处理，最终返回业务数据。</li>
</ol>
<hr>
<h3 id="需求分析和设计">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/26.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/26.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/26.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>基于微信登录实现小程序的登录功能</li>
<li>如果是新用户需要自动完成注册</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/27.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/27.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/27.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



数据量设计（user表）：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/28.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/28.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/28.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="代码开发">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发">#</a></h3>
<p>配置微信登录所需配置项：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/29.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/29.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/29.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



配置为微信用户生成jwt令牌时使用的配置项：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/30.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/30.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/30.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



DTO设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/31.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/31.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/31.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



VO设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/32.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/32.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/32.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



根据接口定义创建UserController的login方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/33.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/33.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/33.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



完善UserController的login方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/34.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/34.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/34.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建UserService接口：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/35.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/35.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/35.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建UserServiceImpl实现类：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/36.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/36.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/36.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在UserServiceImpl中创建私有方法getOpenid：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/37.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/37.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/37.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



完善UserServiceImpl的wxLogin方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/38.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/38.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/38.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



完善UserServiceImpl的wxLogin方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/39.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/39.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/39.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建UserMapper接口：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/40.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/40.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/40.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建UserMapper.xml映射文件：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/41.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/41.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/41.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



编写拦截器JwtTokenUserInterceptor，统一拦截用户端发送的请求并进行jwt校验：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/42.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/42.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/42.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在WebMvcConfiguration配置类中注册拦截器：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/43.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/43.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/43.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="商品浏览功能代码">商品浏览功能代码<a hidden class="anchor" aria-hidden="true" href="#商品浏览功能代码">#</a></h2>
<h3 id="需求分析和设计-1">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-1">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/44.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/44.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/44.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



接口设计：</p>
<ul>
<li>查询分类






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/45.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/45.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/45.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>根据分类id查询菜品






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/46.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/46.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/46.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>根据分类id查询套餐






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/47.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/47.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/47.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
<li>根据套餐id查询包含的菜品






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-7/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-7/48.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-7/48.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-7/48.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://www.steamedfish.top/">©2025 SteamedFish&rsquo;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script src="https://unpkg.com/@barba/core"></script>


<script>
  window.PaperMod = window.PaperMod || {};
  PaperMod.state = { once: false };

  PaperMod.initOnce = function () {
    if (PaperMod.state.once) return;
    PaperMod.state.once = true;

    console.log("PaperMod initOnce");

    if (PaperMod.initAPlayer) {
      PaperMod.initAPlayer();
    }
  };

  PaperMod.initPage = function (container = document) {
    console.log("PaperMod initPage");

    PaperMod.initFancybox && PaperMod.initFancybox(container);
    PaperMod.initCodeCopyButtons && PaperMod.initCodeCopyButtons(container);
  };

  barba.init({
    transitions: [
      {
        name: "default",
        leave() {
          return Promise.resolve();
        },
        enter(data) {
          PaperMod.initOnce();
          PaperMod.initPage(data.next.container);
        },
      },
    ],
  });
  
  document.addEventListener("DOMContentLoaded", () => {
    PaperMod.initOnce();
    PaperMod.initPage(document);
  });
</script>







<link
  href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css"
  rel="stylesheet"
/>
<script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/meting/2.0.2/Meting.min.js"></script>
<script>
window.PaperMod = window.PaperMod || {};
console.log("player.js loaded");
PaperMod.initAPlayer = async function () {
    if (window.__aplayer_inited__) {
      console.log("APlayer already exists, skip");
      return;
    }

    const container = document.getElementById("aplayer");
    if (!container) {
      console.warn("APlayer container not found");
      return;
    }

    console.log("Init APlayer");
    

    const localAudio = [
      
      
      
      
      
      
      
      
    ];

    

    let metingAudio = [];
    try {
      const res = await fetch(
        
"https://api.qijieya.cn/meting/?type=url&id=14079273335"
      );
      metingAudio = await res.json();
    } catch (e) {
      console.warn("Meting load failed, fallback to local only");
    }

    

    const audioList = [...localAudio, ...metingAudio];

    window.aplayer = new APlayer({
      container,
      fixed: true,
      autoplay: true,
      preload: "auto",
      lrcType: 1,
      
      audio: metingAudio,
    });
    console.log("APlayer created with", audioList.length, "tracks");

};
</script>


<script>
  window.PaperMod = window.PaperMod || {};

  PaperMod.initCodeCopyButtons = function (root = document) {
    root.querySelectorAll("pre > code").forEach((codeblock) => {
      const container = codeblock.parentNode.parentNode;

      
      if (container.querySelector(".copy-code")) return;

      const copybutton = document.createElement("button");
      copybutton.classList.add("copy-code");
      copybutton.innerHTML = '复制';

      function copyingDone() {
        copybutton.innerHTML = '已复制！';
        setTimeout(() => {
          copybutton.innerHTML = '复制';
        }, 2000);
      }

      copybutton.addEventListener("click", (cb) => {
        if ("clipboard" in navigator) {
          navigator.clipboard.writeText(codeblock.textContent);
          copyingDone();
          return;
        }

        const range = document.createRange();
        range.selectNodeContents(codeblock);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        try {
          document.execCommand("copy");
          copyingDone();
        } catch (e) {}
        selection.removeRange(range);
      });
      container.appendChild(copybutton);
    });
  };
</script>


<link rel="stylesheet" href="/lib/fancybox/fancybox.css" />
<script src="/lib/fancybox/fancybox.umd.js"></script>
<script>
  function initFancybox() {
    Fancybox.unbind("[data-fancybox]");

    Fancybox.bind("[data-fancybox]", {
      animated: true,
      showClass: "fancybox-fadeIn",
      hideClass: "fancybox-fadeOut",
      dragToClose: true,
    });
  }

  
  if (document.readyState !== "loading") {
    initFancybox();
  } else {
    document.addEventListener("DOMContentLoaded", initFancybox);
  }
  
  document.addEventListener("barba:afterEnter", initFancybox);
</script>







<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
