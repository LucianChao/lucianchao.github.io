<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>【苍穹外卖】（13）数据统计（图像报表、Excel报表） | SteamedFish&#39;s Blog</title>
<meta name="keywords" content="Apache ECharts, 苍穹外卖, Apache POI">
<meta name="description" content="Apache ECharts
Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。
官网地址： https://echarts.apache.org/zh/index.html
Apache Echarts官方提供的快速入门： https://echarts.apache.org/handbook/zh/get-started/






    


       
    




  
    
  
    
  




使用Echarts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。">
<meta name="author" content="">
<link rel="canonical" href="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-14/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.48569ef1d09dace3351ba549c3a7d634e59d1a68544f48e0de83f555e5c3e16e.css" integrity="sha256-SFae8dCdrOM1G6VJw6fWNOWdGmhUT0jg3oP1VeXD4W4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.steamedfish.top/favicon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.steamedfish.top/favicon.png">
<link rel="apple-touch-icon" href="https://www.steamedfish.top/favicon.png">
<link rel="mask-icon" href="https://www.steamedfish.top/favicon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-14/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>





<link
  href="/fonts/lxgw/style.css"
  rel="stylesheet"
/><meta property="og:url" content="https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-14/">
  <meta property="og:site_name" content="SteamedFish&#39;s Blog">
  <meta property="og:title" content="【苍穹外卖】（13）数据统计（图像报表、Excel报表）">
  <meta property="og:description" content="Apache ECharts Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。 官网地址： https://echarts.apache.org/zh/index.html Apache Echarts官方提供的快速入门： https://echarts.apache.org/handbook/zh/get-started/ 使用Echarts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-12-28T22:36:55+08:00">
    <meta property="article:modified_time" content="2025-12-29T00:38:42+08:00">
    <meta property="article:tag" content="Apache ECharts">
    <meta property="article:tag" content="苍穹外卖">
    <meta property="article:tag" content="Apache POI">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【苍穹外卖】（13）数据统计（图像报表、Excel报表）">
<meta name="twitter:description" content="Apache ECharts
Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。
官网地址： https://echarts.apache.org/zh/index.html
Apache Echarts官方提供的快速入门： https://echarts.apache.org/handbook/zh/get-started/






    


       
    




  
    
  
    
  




使用Echarts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.steamedfish.top/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "【苍穹外卖】（13）数据统计（图像报表、Excel报表）",
      "item": "https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-14/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【苍穹外卖】（13）数据统计（图像报表、Excel报表）",
  "name": "【苍穹外卖】（13）数据统计（图像报表、Excel报表）",
  "description": "Apache ECharts Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。 官网地址： https://echarts.apache.org/zh/index.html Apache Echarts官方提供的快速入门： https://echarts.apache.org/handbook/zh/get-started/ 使用Echarts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。\n",
  "keywords": [
    "Apache ECharts", "苍穹外卖", "Apache POI"
  ],
  "articleBody": "Apache ECharts Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。 官网地址： https://echarts.apache.org/zh/index.html Apache Echarts官方提供的快速入门： https://echarts.apache.org/handbook/zh/get-started/ 使用Echarts，重点在于研究当前图表所需的数据格式。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。\n营业额统计 需求分析和设计 产品原型： 业务规则：\n营业额指订单状态为已完成的订单金额合计 基于可视化报表的折线图展示营业额数据，X轴为日期，Y轴为营业额 根据时间选择区间，展示每天的营业额数据 接口设计： 代码开发 根据接口定义设计对应的VO： 根据接口定义创建ReportController： 创建ReportService接口，声明getTurnover方法： 创建ReportServiceImpl实现类，实现getTurnover方法： 在OrderMapper接口声明sumByMap方法： 在OrderMapper.xml文件中编写动态SQL： 用户统计 需求分析和设计 产品原型： 业务规则：\n基于可视化报表的折线图展示用户数据，X轴为日期，Y轴为用户数 根据时间选择区间，展示每天的用户总量和新增用户量数据 接口设计： 代码开发 根据用户统计接口的返回结果设计VO： 根据接口定义，在ReportController中创建userStatistics方法： 在ReportService接口中声明getUserStatistics方法： 在ReportServiceImpl实现类中实现getUserStatistics方法： 在ReportServiceImpl实现类中创建私有方法getUserCount： 在UserMapper接口中声明countByMap方法： 在UserMapper.xml文件中编写动态SQL： 订单统计 需求分析和设计 产品原型： 业务规则：\n有效订单指状态为 “已完成” 的订单 基于可视化报表的折线图展示订单数据，X轴为日期，Y轴为订单数量 根据时间选择区间，展示每天的订单总数和有效订单数 展示所选时间区间内的有效订单数、总订单数、订单完成率，订单完成率 = 有效订单数 / 总订单数 * 100% 接口设计： 代码开发 根据订单统计接口的返回结果设计VO： 在ReportController中根据订单统计接口创建orderStatistics方法： 在ReportService接口中声明getOrderStatistics方法： 在ReportServiceImpl实现类中实现getOrderStatistics方法： 在ReportServiceImpl实现类中提供私有方法getOrderCount： 在OrderMapper接口中声明countByMap方法： 在OrderMapper.xml文件中编写动态SQL： 销量排名Top10 需求分析和设计 产品原型： 业务规则：\n根据时间选择区间，展示销量前10的商品（包括菜品和套餐） 基于可视化报表的柱状图降序展示商品销量 此处的销量为商品销售的份数 接口设计： 代码开发 根据销量排名接口的返回结果设计VO： 在ReportController中根据销量排名接口创建top10方法： 在ReportService接口中声明getSalesTop10方法： 在ReportServiceImpl实现类中实现getSalesTop10方法： 在OrderMapper接口中声明getSalesTop10方法： 在OrderMapper.xml文件中编写动态SQL： 工作台 需求分析和设计 工作台是系统运营的数据看板，并提供快捷操作入口，可以有效提高商家的工作效率。\n工作台展示的数据：\n今日数据 订单管理 菜品总览 套餐总览 订单信息 接口设计： 今日数据接口 订单管理接口 菜品总览接口 套餐总览接口 订单搜索（已完成） 各个状态的订单数量统计（已完成） 今日数据的接口设计： 订单管理的接口设计： 菜品总览的接口设计： 套餐总览的接口设计： 代码导入 直接导入资料中的工作台模块功能代码： Apache POI Apache POI 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用 POI 在 Java 程序中对Miscrosoft Office各种文件进行读写操作。\n一般情况下，POI 都是用于操作 Excel 文件。 Apache POI 的应用场景：\n银行网银系统导出交易明细 各种业务系统导出Excel报表 批量导入业务数据 快速入门 Apache POI的maven坐标： 将数据写入Excel文件： 读取Excel文件中的数据： 导出运营数据Excel报表 需求分析和设计 产品原型： 导出的Excel报表格式： 业务规则：\n导出Excel形式的报表文件 导出最近30天的运营数据 接口设计： 信息\n当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器\n代码开发 实现步骤：\n设计Excel模板文件 查询近30天的运营数据 将查询到的运营数据写入模板文件 通过输出流将Excel文件下载到客户端浏览器 根据接口定义，在ReportController中创建export方法： 在ReportService接口中声明导出运营数据报表的方法： 在ReportServiceImpl实现类中实现导出运营数据报表的方法： ",
  "wordCount" : "2089",
  "inLanguage": "zh",
  "datePublished": "2025-12-28T22:36:55+08:00",
  "dateModified": "2025-12-29T00:38:42+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.steamedfish.top/post/java-project/sky-take-out/sky-take-out-14/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SteamedFish's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.steamedfish.top/favicon.png"
    }
  }
}
</script>
</head>

<body data-barba="wrapper" class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.steamedfish.top/" accesskey="h" title="SteamedFish&#39;s Blog (Alt + H)">SteamedFish&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="https://www.steamedfish.top/en/" title="English"
                                aria-label="English">En</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.steamedfish.top/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://www.steamedfish.top/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main" data-barba="container" data-barba-namespace="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      【苍穹外卖】（13）数据统计（图像报表、Excel报表）
    </h1>
    <div class="post-meta">






<span title='2025-12-28 22:36:55 +0800 +0800'>2025-12-28</span>&nbsp;·&nbsp;<span title='2025-12-29 00:38:42 +0800 +0800'>(最后修改于 2025-12-29)</span>&nbsp;·&nbsp;<span>5 分钟</span>&nbsp;|&nbsp;<span>
    <a href="https://github.com/LucianChao/Hugo_Blog/tree/main/content/post/java-project/sky-take-out/sky-take-out-14/index.md" rel="noopener noreferrer edit" target="_blank">编辑此文章</a>
</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#apache-echarts" aria-label="Apache ECharts">Apache ECharts</a></li>
                <li>
                    <a href="#%e8%90%a5%e4%b8%9a%e9%a2%9d%e7%bb%9f%e8%ae%a1" aria-label="营业额统计">营业额统计</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91" aria-label="代码开发">代码开发</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%94%a8%e6%88%b7%e7%bb%9f%e8%ae%a1" aria-label="用户统计">用户统计</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-1" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91-1" aria-label="代码开发">代码开发</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%ae%a2%e5%8d%95%e7%bb%9f%e8%ae%a1" aria-label="订单统计">订单统计</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-2" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91-2" aria-label="代码开发">代码开发</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%94%80%e9%87%8f%e6%8e%92%e5%90%8dtop10" aria-label="销量排名Top10">销量排名Top10</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-3" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91-3" aria-label="代码开发">代码开发</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b7%a5%e4%bd%9c%e5%8f%b0" aria-label="工作台">工作台</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-4" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%af%bc%e5%85%a5" aria-label="代码导入">代码导入</a></li></ul>
                </li>
                <li>
                    <a href="#apache-poi" aria-label="Apache POI">Apache POI</a><ul>
                        
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8" aria-label="快速入门">快速入门</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%af%bc%e5%87%ba%e8%bf%90%e8%90%a5%e6%95%b0%e6%8d%aeexcel%e6%8a%a5%e8%a1%a8" aria-label="导出运营数据Excel报表">导出运营数据Excel报表</a><ul>
                        
                <li>
                    <a href="#%e9%9c%80%e6%b1%82%e5%88%86%e6%9e%90%e5%92%8c%e8%ae%be%e8%ae%a1-5" aria-label="需求分析和设计">需求分析和设计</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e5%bc%80%e5%8f%91-4" aria-label="代码开发">代码开发</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="apache-echarts">Apache ECharts<a hidden class="anchor" aria-hidden="true" href="#apache-echarts">#</a></h2>
<p>Apache ECharts 是一款基于 Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。
官网地址： <a href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a>
Apache Echarts官方提供的快速入门： <a href="https://echarts.apache.org/handbook/zh/get-started/">https://echarts.apache.org/handbook/zh/get-started/</a>






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/1.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/1.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/1.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



使用Echarts，重点在于研究当前图表所需的<strong>数据格式</strong>。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。</p>
<hr>
<h2 id="营业额统计">营业额统计<a hidden class="anchor" aria-hidden="true" href="#营业额统计">#</a></h2>
<h3 id="需求分析和设计">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/2.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/2.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/2.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>营业额指订单状态为已完成的订单金额合计</li>
<li>基于可视化报表的折线图展示营业额数据，X轴为日期，Y轴为营业额</li>
<li>根据时间选择区间，展示每天的营业额数据</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/3.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/3.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/3.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="代码开发">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发">#</a></h3>
<p>根据接口定义设计对应的VO：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/4.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/4.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/4.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



根据接口定义创建ReportController：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/5.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/5.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/5.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建ReportService接口，声明getTurnover方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/6.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/6.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/6.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



创建ReportServiceImpl实现类，实现getTurnover方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/7.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/7.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/7.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/8.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/8.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/8.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper接口声明sumByMap方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/9.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/9.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/9.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper.xml文件中编写动态SQL：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/10.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/10.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/10.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="用户统计">用户统计<a hidden class="anchor" aria-hidden="true" href="#用户统计">#</a></h2>
<h3 id="需求分析和设计-1">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-1">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/11.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/11.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/11.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>基于可视化报表的折线图展示用户数据，X轴为日期，Y轴为用户数</li>
<li>根据时间选择区间，展示每天的用户总量和新增用户量数据</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/12.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/12.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/12.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="代码开发-1">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发-1">#</a></h3>
<p>根据用户统计接口的返回结果设计VO：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/13.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/13.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/13.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



根据接口定义，在ReportController中创建userStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/14.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/14.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/14.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportService接口中声明getUserStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/15.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/15.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/15.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中实现getUserStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/16.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/16.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/16.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/17.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/17.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/17.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中创建私有方法getUserCount：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/18.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/18.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/18.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在UserMapper接口中声明countByMap方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/19.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/19.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/19.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在UserMapper.xml文件中编写动态SQL：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/20.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/20.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/20.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="订单统计">订单统计<a hidden class="anchor" aria-hidden="true" href="#订单统计">#</a></h2>
<h3 id="需求分析和设计-2">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-2">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/21.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/21.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/21.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>有效订单指状态为 “已完成” 的订单</li>
<li>基于可视化报表的折线图展示订单数据，X轴为日期，Y轴为订单数量</li>
<li>根据时间选择区间，展示每天的订单总数和有效订单数</li>
<li>展示所选时间区间内的有效订单数、总订单数、订单完成率，订单完成率 = 有效订单数 / 总订单数 * 100%</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/22.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/22.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/22.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="代码开发-2">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发-2">#</a></h3>
<p>根据订单统计接口的返回结果设计VO：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/23.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/23.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/23.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportController中根据订单统计接口创建orderStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/24.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/24.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/24.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportService接口中声明getOrderStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/25.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/25.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/25.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中实现getOrderStatistics方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/26.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/26.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/26.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/27.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/27.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/27.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/28.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/28.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/28.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中提供私有方法getOrderCount：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/29.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/29.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/29.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper接口中声明countByMap方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/30.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/30.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/30.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper.xml文件中编写动态SQL：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/31.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/31.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/31.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="销量排名top10">销量排名Top10<a hidden class="anchor" aria-hidden="true" href="#销量排名top10">#</a></h2>
<h3 id="需求分析和设计-3">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-3">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/32.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/32.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/32.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>根据时间选择区间，展示销量前10的商品（包括菜品和套餐）</li>
<li>基于可视化报表的柱状图降序展示商品销量</li>
<li>此处的销量为商品销售的份数</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/33.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/33.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/33.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h3 id="代码开发-3">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发-3">#</a></h3>
<p>根据销量排名接口的返回结果设计VO：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/34.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/34.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/34.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportController中根据销量排名接口创建top10方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/35.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/35.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/35.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportService接口中声明getSalesTop10方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/36.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/36.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/36.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中实现getSalesTop10方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/37.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/37.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/37.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper接口中声明getSalesTop10方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/38.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/38.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/38.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在OrderMapper.xml文件中编写动态SQL：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/39.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/39.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/39.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="工作台">工作台<a hidden class="anchor" aria-hidden="true" href="#工作台">#</a></h2>
<h3 id="需求分析和设计-4">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-4">#</a></h3>
<p>工作台是系统运营的数据看板，并提供快捷操作入口，可以有效提高商家的工作效率。<br>
工作台展示的数据：</p>
<ul>
<li>今日数据</li>
<li>订单管理</li>
<li>菜品总览</li>
<li>套餐总览</li>
<li>订单信息






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/40.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/40.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/40.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



接口设计：</li>
<li>今日数据接口</li>
<li>订单管理接口</li>
<li>菜品总览接口</li>
<li>套餐总览接口</li>
<li>订单搜索（已完成）</li>
<li>各个状态的订单数量统计（已完成）</li>
</ul>
<p>今日数据的接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/41.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/41.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/41.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



订单管理的接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/42.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/42.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/42.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



菜品总览的接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/43.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/43.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/43.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



套餐总览的接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/44.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/44.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/44.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<h3 id="代码导入">代码导入<a hidden class="anchor" aria-hidden="true" href="#代码导入">#</a></h3>
<p>直接导入资料中的工作台模块功能代码：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/45.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/45.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/45.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<h2 id="apache-poi">Apache POI<a hidden class="anchor" aria-hidden="true" href="#apache-poi">#</a></h2>
<p>Apache POI 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用 POI 在 Java 程序中对Miscrosoft Office各种文件进行读写操作。<br>
一般情况下，POI 都是用于操作 Excel 文件。






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/46.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/46.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/46.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



Apache POI 的应用场景：</p>
<ul>
<li>银行网银系统导出交易明细</li>
<li>各种业务系统导出Excel报表</li>
<li>批量导入业务数据






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/47.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/47.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/47.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</li>
</ul>
<hr>
<h3 id="快速入门">快速入门<a hidden class="anchor" aria-hidden="true" href="#快速入门">#</a></h3>
<p>Apache POI的maven坐标：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/48.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/48.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/48.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



将数据写入Excel文件：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/49.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/49.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/49.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



读取Excel文件中的数据：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/50.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/50.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/50.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>
<h2 id="导出运营数据excel报表">导出运营数据Excel报表<a hidden class="anchor" aria-hidden="true" href="#导出运营数据excel报表">#</a></h2>
<h3 id="需求分析和设计-5">需求分析和设计<a hidden class="anchor" aria-hidden="true" href="#需求分析和设计-5">#</a></h3>
<p>产品原型：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/51.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/51.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/51.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



导出的Excel报表格式：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/52.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/52.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/52.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



业务规则：</p>
<ul>
<li>导出Excel形式的报表文件</li>
<li>导出最近30天的运营数据</li>
</ul>
<p>接口设计：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/53.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/53.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/53.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<!-- FM:Snippet:Start data:{"id":"st-notice","fields":[]} -->
<style type="text/css">
     
    .notice {
        --title-color: #fff;
        --title-background-color: #6be;
        --content-color: #444;
        --content-background-color: #e7f2fa;
    }

    .notice.info {
        --title-background-color: #fb7;
        --content-background-color: #fec;
    }

    .notice.tip {
        --title-background-color: #5a5;
        --content-background-color: #efe;
    }

    .notice.warning {
        --title-background-color: #c33;
        --content-background-color: #fee;
    }

     
    

    body.dark .notice {
        --title-color: #fff;
        --title-background-color: #069;
        --content-color: #ddd;
        --content-background-color: #023;
    }

    body.dark .notice.info {
        --title-background-color: #a50;
        --content-background-color: #420;
    }

    body.dark .notice.tip {
        --title-background-color: #363;
        --content-background-color: #121;
    }

    body.dark .notice.warning {
        --title-background-color: #800;
        --content-background-color: #400;
    }

     
    .notice {
        padding: 18px;
        line-height: 24px;
        margin-bottom: 24px;
        border-radius: 4px;
        color: var(--content-color);
        background: var(--content-background-color);
    }

    .notice p:last-child {
        margin-bottom: 0
    }

     
    .notice-title {
        margin: -18px -18px 12px;
        padding: 4px 18px;
        border-radius: 4px 4px 0 0;
        font-weight: 700;
        color: var(--title-color);
        background: var(--title-background-color);
    }

     
    .icon-notice {
        display: inline-flex;
        align-self: center;
        margin-right: 8px;
    }

    .icon-notice img,
    .icon-notice svg {
        height: 1em;
        width: 1em;
        fill: currentColor;
    }

    .icon-notice img,
    .icon-notice.baseline svg {
        top: .125em;
        position: relative;
    }
</style><div class="notice info" >
    <p class="notice-title">
        <span class="icon-notice baseline">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc. --><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
        </span>信息</p><p>当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器</p></div>
<!-- FM:Snippet:End -->
<hr>
<h3 id="代码开发-4">代码开发<a hidden class="anchor" aria-hidden="true" href="#代码开发-4">#</a></h3>
<p>实现步骤：</p>
<ol>
<li>设计Excel模板文件</li>
<li>查询近30天的运营数据</li>
<li>将查询到的运营数据写入模板文件</li>
<li>通过输出流将Excel文件下载到客户端浏览器</li>
</ol>
<hr>
<p>根据接口定义，在ReportController中创建export方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/54.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/54.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/54.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportService接口中声明导出运营数据报表的方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/55.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/55.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/55.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>



在ReportServiceImpl实现类中实现导出运营数据报表的方法：






    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/56.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/56.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/56.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/57.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/57.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/57.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>









    


       
    



<div class="post-img-view">
  <a
    data-fancybox="post-post/java-project/sky-take-out/sky-take-out-14/index.md"
    href="/post/java-project/sky-take-out/sky-take-out-14/58.png"
    data-caption=""
    data-barba-prevent="all"
  >
    <img
      src="/post/java-project/sky-take-out/sky-take-out-14/58.png"
      srcset="/post/java-project/sky-take-out/sky-take-out-14/58.png 2x"
      alt=""
      loading="lazy"
      style="max-width: 100%; height: auto;"
    />
  </a>
    
  
</div>


</p>
<hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.steamedfish.top/tags/apache-echarts/">Apache ECharts</a></li>
      <li><a href="https://www.steamedfish.top/tags/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96/">苍穹外卖</a></li>
      <li><a href="https://www.steamedfish.top/tags/apache-poi/">Apache POI</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><a href="https://www.steamedfish.top/">©2025 SteamedFish&rsquo;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script src="https://unpkg.com/@barba/core"></script>


<script>
window.PaperMod = window.PaperMod || {};
PaperMod.state = { once: false };

PaperMod.initOnce = function () {
  
  if (PaperMod.state.once) return;
  PaperMod.state.once = true;
  console.log("PaperMod initOnce");

  
  if (PaperMod.initAPlayer && !window.__aplayer_inited__) {
    PaperMod.initAPlayer();
  }
};

PaperMod.initPage = function (container = document) {
  console.log("PaperMod initPage");

  PaperMod.initFancybox && PaperMod.initFancybox(container);
  PaperMod.initCodeCopyButtons && PaperMod.initCodeCopyButtons(container);
};


barba.init({
  transitions: [
    {
      name: "default",
      leave() {
        return Promise.resolve();
      },
      enter(data) {
        
        PaperMod.initOnce();
        PaperMod.initPage(data.next.container);
      },
    },
  ],
});



document.addEventListener("DOMContentLoaded", () => {
  PaperMod.initOnce();
  PaperMod.initPage(document);
});

</script>







<link
  href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css"
  rel="stylesheet"
/>
<script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/meting/2.0.2/Meting.min.js"></script>

<meting-js
  server="netease"
  fixed="true"
  lrc-type="1"
  type="playlist"
  id="2245453903"
  api="https://api.qijieya.cn/meting/?type=:type&id=:id"
  >
  
  
         
  
  
  
</meting-js>
<script>
  if (window.Barba) {
    Barba.hooks.afterEnter(function () {
      const metingPlayer = document.querySelector('meting-js');
      if (metingPlayer) {
        metingPlayer.load();  
      }
    });
  }
  
  
  
  
  
  
  

  
  
  
  
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  
  

  
  
  
  
  
  
  
  
  
  
  

  
  
  

  
  
  
</script>




<script>
  window.PaperMod = window.PaperMod || {};

  PaperMod.initCodeCopyButtons = function (root = document) {
    root.querySelectorAll("pre > code").forEach((codeblock) => {
      const container = codeblock.parentNode.parentNode;

      
      if (container.querySelector(".copy-code")) return;

      const copybutton = document.createElement("button");
      copybutton.classList.add("copy-code");
      copybutton.innerHTML = '复制';

      function copyingDone() {
        copybutton.innerHTML = '已复制！';
        setTimeout(() => {
          copybutton.innerHTML = '复制';
        }, 2000);
      }

      copybutton.addEventListener("click", (cb) => {
        if ("clipboard" in navigator) {
          navigator.clipboard.writeText(codeblock.textContent);
          copyingDone();
          return;
        }

        const range = document.createRange();
        range.selectNodeContents(codeblock);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        try {
          document.execCommand("copy");
          copyingDone();
        } catch (e) {}
        selection.removeRange(range);
      });
      container.appendChild(copybutton);
    });
  };
</script>


<link rel="stylesheet" href="/lib/fancybox/fancybox.css" />
<script src="/lib/fancybox/fancybox.umd.js"></script>
<script>
  function initFancybox() {
    Fancybox.unbind("[data-fancybox]");

    Fancybox.bind("[data-fancybox]", {
      animated: true,
      showClass: "fancybox-fadeIn",
      hideClass: "fancybox-fadeOut",
      dragToClose: true,
    });
  }

  
  if (document.readyState !== "loading") {
    initFancybox();
  } else {
    document.addEventListener("DOMContentLoaded", initFancybox);
  }
  
  document.addEventListener("barba:afterEnter", initFancybox);
</script>







<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
